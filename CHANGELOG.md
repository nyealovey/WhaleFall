# 更新日志

## [1.0.9] - 2025-09-25

### ✨ 新功能
- 新增统一搜索框组件，支持跨页面复用筛选功能
- 新增状态筛选功能，支持同步记录和会话中心的状态筛选
- 新增标签筛选功能，支持多标签选择和动态显示
- 新增智能页面检测，自动识别JavaScript动态页面和传统表格页面
- 新增统计卡片动态更新，根据筛选条件实时更新统计数据

### 🔧 改进
- 优化日志中心时间范围筛选，默认显示最近1天的数据
- 简化时间范围选项，保留最近1小时、1天、1周、1月、全部时间
- 改进筛选组件布局，状态筛选位置调整到同步类型右侧
- 优化标签选择显示，标签显示在选择按钮右侧并支持动态宽度
- 改进筛选参数传递，支持空字符串参数的正确传递

### 🐛 修复
- 修复会话中心筛选后一直转圈的问题
- 修复日志中心筛选功能失效的问题
- 修复标签管理404错误，更正API端点路径
- 修复统一搜索组件重复初始化问题
- 修复元素ID不匹配导致的筛选失效问题

### 🧹 清理
- 移除调试日志输出，清理控制台信息
- 简化代码逻辑，移除不必要的智能检测功能
- 优化错误处理，确保筛选完成后正确隐藏加载状态

## [1.0.8] - 2025-09-24

### ✨ 新功能
- 新增批量标签管理功能，支持批量分配和移除标签
- 新增标签分组显示功能，按分类组织标签列表
- 新增实例分组管理功能，按数据库类型组织实例列表
- 新增简化移除模式，只需选择实例即可移除所有标签
- 新增选中标签显示功能，在模态框底部显示已选择的标签

### 🔧 改进
- 优化标签管理界面，提供更直观的分组和筛选体验
- 改进批量操作流程，支持分配模式和移除模式切换
- 优化标签分类显示，从数据库动态读取分类名称
- 改进实例选择界面，按数据库类型进行分组显示
- 优化日志页面显示，修复分页和递归调用问题

### 🐛 修复
- 修复批量分配标签功能的500错误问题
- 修复实例属性访问错误（`instance_name` vs `name`）
- 修复标签分类名称硬编码问题
- 修复批量移除所有标签功能的SQLAlchemy关系处理问题
- 修复日志页面JavaScript递归调用导致的堆栈溢出问题
- 删除不必要的调试日志，提高系统性能

## [1.0.7] - 2025-09-24

### 🐛 修复
- 修复自动分类规则匹配BUG，解决SQL Server `db_owner` 权限无法正确匹配的问题
- 修复MySQL `GRANT OPTION` 权限规则匹配失败的问题
- 修复定时任务无法正确结束的问题，会话状态一直显示 `running`
- 修复定时任务中所有实例停留在 `pending` 状态的问题
- 修复会话状态更新逻辑，确保定时任务与手动同步行为一致
- 修复进度条计算逻辑，现在始终显示成功率而不是完成率
- 修复用户管理页面CSRF token获取问题
- 修复用户编辑和新建时的400错误问题

### 🔧 改进
- 分离所有JavaScript和CSS文件，提高代码可维护性
- 优化定时任务执行流程，移除不必要的确认弹窗
- 改进进度条显示逻辑，提供更准确的同步状态反馈
- 优化会话状态更新机制，确保状态正确转换
- 改进错误处理和日志记录，提供更详细的调试信息

### 🎯 功能增强
- 增强自动分类规则匹配算法，支持更复杂的权限组合
- 优化MySQL权限解析，正确处理 `ALL PRIVILEGES` 和 `WITH GRANT OPTION`
- 改进定时任务监控，提供实时的执行状态和统计信息
- 增强用户管理功能，支持密码设置和状态切换

### 📚 文档
- 新增规则匹配BUG修复文档
- 新增定时任务问题诊断和修复指南
- 更新用户管理功能使用说明
- 完善代码分离和重构文档

### 🔒 安全
- 修复CSRF token验证问题
- 改进用户输入验证和错误处理
- 增强API安全性检查

---

## [1.0.6] - 2025-09-22

### 🐛 修复
- 修复权限API URL不匹配问题，解决权限按钮404错误
- 修复SQL Server重复角色权限显示问题（V2版本）
- 修复PostgreSQL枚举类型不存在错误
- 修复权限模态框无法弹出的问题
- 修复CurrentAccountSyncData对象属性错误

### 🔧 改进
- 优化标签操作日志记录，减少日志噪音
- 精简权限同步调试日志
- 统一前后端URL配置，确保API调用一致性
- 改进权限查看组件的错误处理

### 📚 文档
- 新增权限API URL修复文档
- 新增SQL Server重复权限修复V2文档
- 新增PostgreSQL枚举类型修复文档
- 新增权限模态框修复文档
- 新增标签日志优化文档

### 🔒 安全
- 配置Git忽略规则，防止敏感数据上传
- 完善权限API调用的CSRF保护

---

## [1.0.1] - 2024-09-20

### 🎉 新功能
- 新增生产环境一键部署脚本 `deploy-prod-v1.0.1.sh`
- 优化生产环境Flask启动脚本，移除对PostgreSQL和Redis的依赖检查
- 完善生产环境配置验证和部署流程

### 🔧 改进
- 简化生产环境启动流程，提高部署效率
- 优化Docker配置，支持企业代理环境
- 完善环境变量验证机制
- 改进健康检查逻辑

### 🐛 修复
- 修复Nginx配置中未定义的日志格式问题
- 修复Docker容器启动失败问题
- 修复环境变量验证脚本的兼容性问题

### 📚 文档
- 新增生产环境部署指南
- 新增开发vs生产环境配置对比文档
- 新增生产环境配置验证报告
- 完善部署文档中心

### 🔒 安全
- 加强生产环境安全配置
- 优化敏感信息处理
- 完善日志安全策略

### 🚀 部署
- 提供一键生产环境部署脚本
- 支持代理环境部署
- 完善部署验证机制

---

## [1.0.0] - 2024-09-19

### 🎉 初始版本
- 基于Flask的DBA数据库管理Web应用
- 支持PostgreSQL、MySQL、SQL Server、Oracle数据库
- 提供账户分类管理、权限规则管理、数据同步等功能
- 完整的Docker容器化部署支持
- 基于APScheduler的定时任务管理
- 完善的日志监控和健康检查

### 核心功能
- 多数据库实例管理
- 智能账户分类与权限规则管理
- 数据同步和变更追踪
- 定时任务调度
- 用户认证和权限管理
- 系统监控和日志管理

### 技术栈
- 后端: Flask 3.1.2 + SQLAlchemy 2.0.43 + APScheduler 3.11.0
- 前端: Bootstrap 5.3.2 + jQuery 3.7.1 + Chart.js 4.4.0
- 数据库: PostgreSQL 15 + Redis 7.4.0
- 容器化: Docker + Docker Compose + Nginx + Supervisor
- Python环境: Python 3.11 + uv包管理器