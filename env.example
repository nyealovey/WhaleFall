# 服务器正式环境配置示例（x86，有代理）
# 复制此文件为 .env 并修改相应配置
# 注意：此文件为示例模板，禁止写入真实密钥/口令并提交到仓库；生产环境请通过部署系统注入或仅写入未跟踪的 .env

# ============================================================================
# 代理配置
# ============================================================================
# HTTP代理
HTTP_PROXY=http://proxy.company.com:8080
HTTPS_PROXY=http://proxy.company.com:8080

# 不使用代理的地址
NO_PROXY=localhost,127.0.0.1,::1,internal.company.com

# 小写版本（某些工具需要）
http_proxy=http://proxy.company.com:8080
https_proxy=http://proxy.company.com:8080
no_proxy=localhost,127.0.0.1,::1,internal.company.com

# ============================================================================
# 数据库配置
# ============================================================================
POSTGRES_DB=whalefall_prod
POSTGRES_USER=whalefall_user
POSTGRES_PASSWORD=

# ============================================================================
# Redis配置
# ============================================================================
REDIS_PASSWORD=

# ============================================================================
# 应用安全配置
# ============================================================================
# SECRET_KEY/JWT_SECRET_KEY 用于会话/JWT 签名，生产必须固定且随机生成
# 生成示例: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=
JWT_SECRET_KEY=
BCRYPT_LOG_ROUNDS=12
# 用于数据库凭据加/解密(生产环境必须固定,否则重启后无法解密已存储的密码)
# 生成示例: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
PASSWORD_ENCRYPTION_KEY=

# ============================================================================
# 应用配置
# ============================================================================
APP_NAME=鲸落
APP_VERSION=1.3.5
FLASK_ENV=production
FLASK_DEBUG=0
LOG_LEVEL=INFO

# ============================================================================
# 反向代理(入站) / ProxyFix
# ============================================================================
# 说明:
# - 当应用处于 Nginx/负载均衡反向代理后方时,需要让 Flask 正确解析 X-Forwarded-* 获取真实 IP/协议.
# - 下列配置默认适配“容器内置 Nginx → 127.0.0.1:5001”模式.
PROXY_FIX_X_FOR=1
PROXY_FIX_X_PROTO=1
PROXY_FIX_X_HOST=0
PROXY_FIX_X_PORT=0
PROXY_FIX_X_PREFIX=0
# 仅信任来自这些代理 IP 的 X-Forwarded-* 头部,防止直连暴露端口时被伪造
PROXY_FIX_TRUSTED_IPS=127.0.0.1,::1

# ============================================================================
# 缓存配置
# ============================================================================
CACHE_TYPE=redis
# 使用容器服务名连接
CACHE_REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

# ============================================================================
# 数据库连接配置
# ============================================================================
# 使用容器服务名连接
DATABASE_URL=postgresql+psycopg://whalefall_user:${POSTGRES_PASSWORD}@postgres:5432/whalefall_prod

# ============================================================================
# 会话配置
# ============================================================================
PERMANENT_SESSION_LIFETIME=3600

# ============================================================================
# 其他配置
# ============================================================================
DEBUG=false
TESTING=false
