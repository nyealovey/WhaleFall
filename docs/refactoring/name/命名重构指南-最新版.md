# å‘½åè§„èŒƒé‡æ„æŒ‡å—ï¼ˆ2025-11-18 æœ€æ–°ç‰ˆï¼‰

> åŸºäºå®é™…ä»£ç æ‰«æçš„å‡†ç¡®é‡æ„æ–¹æ¡ˆ

## ğŸ“Š å®é™…é—®é¢˜ç»Ÿè®¡

**æ€»è®¡**: çº¦ 60 é¡¹å‘½åé—®é¢˜
- åç«¯æ–‡ä»¶: 16 ä¸ªï¼ˆè·¯ç”± 2 + è§†å›¾ 7 + æœåŠ¡ 9ï¼‰
- å‰ç«¯æ–‡ä»¶: å·²å¤§éƒ¨åˆ†å®Œæˆé‡æ„ï¼ˆç›®å½•å’Œä¸»è¦æ–‡ä»¶å·²ä½¿ç”¨ kebab-caseï¼‰
- å‡½æ•°å‘½å: çº¦ 40 ä¸ªï¼ˆapi_ å‰ç¼€ + _api åç¼€ï¼‰

**é¢„è®¡æ—¶é—´**: 3-5 å¤© | **é£é™©**: ä½-ä¸­

---

## âœ… å·²å®Œæˆçš„é‡æ„

ä»¥ä¸‹å†…å®¹å·²ç»å®Œæˆï¼Œæ— éœ€å†æ¬¡é‡æ„ï¼š

### å‰ç«¯ç›®å½•
- âœ… `capacity-stats/` å·²ä½¿ç”¨è¿å­—ç¬¦
- âœ… `classification-rules/` å·²ä½¿ç”¨è¿å­—ç¬¦

### å‰ç«¯æ–‡ä»¶
- âœ… `database-aggregations.js` å·²ä½¿ç”¨è¿å­—ç¬¦
- âœ… `instance-aggregations.js` å·²ä½¿ç”¨è¿å­—ç¬¦
- âœ… `tag-selector.css` å·²ä½¿ç”¨è¿å­—ç¬¦
- âœ… å…¶ä»–ä¸»è¦æ–‡ä»¶å·²ä½¿ç”¨ kebab-case

---

## ğŸ”´ å¾…é‡æ„æ¸…å•

### 1. åç«¯æ–‡ä»¶é‡å‘½åï¼ˆ16 ä¸ªï¼‰

#### è·¯ç”±æ–‡ä»¶ï¼ˆ2 ä¸ªï¼‰
```bash
app/routes/database_aggr.py â†’ database_aggregations.py
app/routes/instance_aggr.py â†’ instance_aggregations.py
```

#### è§†å›¾æ–‡ä»¶ï¼ˆ7 ä¸ªï¼‰
```bash
app/views/
  account_classification_form_view.py â†’ classification_forms.py
  change_password_form_view.py â†’ password_forms.py
  credential_form_view.py â†’ credential_forms.py
  instance_form_view.py â†’ instance_forms.py
  scheduler_job_form_view.py â†’ scheduler_forms.py
  tag_form_view.py â†’ tag_forms.py
  user_form_view.py â†’ user_forms.py
```

#### æœåŠ¡æ–‡ä»¶ï¼ˆ9 ä¸ªï¼‰
```bash
app/services/form_service/
  change_password_form_service.py â†’ password_service.py
  classification_form_service.py â†’ classification_service.py
  classification_rule_form_service.py â†’ classification_rule_service.py
  credentials_form_service.py â†’ credential_service.py
  instances_form_service.py â†’ instance_service.py
  resource_form_service.py â†’ resource_service.py
  scheduler_job_form_service.py â†’ scheduler_job_service.py
  tags_form_service.py â†’ tag_service.py
  users_form_service.py â†’ user_service.py
```

### 2. å‡½æ•°é‡å‘½åï¼ˆçº¦ 40 ä¸ªï¼‰

#### ç§»é™¤ api_ å‰ç¼€ï¼ˆçº¦ 25 ä¸ªï¼‰

**routes/users.py (6 ä¸ª)**
```python
api_get_users() â†’ list_users()
api_get_user() â†’ get_user()
api_create_user() â†’ create_user()
api_update_user() â†’ update_user()
api_delete_user() â†’ delete_user()
api_get_stats() â†’ get_stats()
```

**routes/instance.py (3 ä¸ª)**
```python
api_list() â†’ list_instances()
api_detail() â†’ get_instance()
api_get_accounts() â†’ get_accounts()
```

**routes/credentials.py (2 ä¸ª)**
```python
api_list() â†’ list_credentials()
api_detail() â†’ get_credential()
```

**routes/tags.py (4 ä¸ª)**
```python
api_tags() â†’ list_tags()
api_categories() â†’ list_categories()
api_tag_detail() â†’ get_tag()
api_tag_detail_by_id() â†’ get_tag_by_id()
```

**routes/tags_batch.py (3 ä¸ª)**
```python
api_instance_tags() â†’ get_instance_tags()
api_instances() â†’ list_instances()
api_all_tags() â†’ list_all_tags()
```

**routes/sync_sessions.py (4 ä¸ª)**
```python
api_list_sessions() â†’ list_sessions()
api_get_session_detail() â†’ get_session_detail()
api_cancel_session() â†’ cancel_session()
api_get_error_logs() â†’ get_error_logs()
```

**routes/dashboard.py (4 ä¸ª)**
```python
api_overview() â†’ get_overview()
api_charts() â†’ get_charts()
api_activities() â†’ get_activities()
api_status() â†’ get_status()
```

**routes/health.py (2 ä¸ª)**
```python
api_health() â†’ get_health()
api_cache_health() â†’ get_cache_health()
```

**routes/instance_statistics.py (1 ä¸ª)**
```python
api_statistics() â†’ get_statistics()
```

#### ç»Ÿä¸€ _api åç¼€ï¼ˆçº¦ 10 ä¸ªï¼‰

**routes/account_stat.py (4 ä¸ª)**
```python
statistics_api() â†’ get_statistics()
statistics_summary_api() â†’ get_statistics_summary()
statistics_db_type_api() â†’ get_statistics_by_db_type()
statistics_classification_api() â†’ get_classification_statistics()
```

**routes/auth.py (2 ä¸ª)**
```python
login_api() â†’ login()
change_password_api() â†’ change_password()
```

**routes/credentials.py (2 ä¸ª)**
```python
create_api() â†’ create_credential()
edit_api() â†’ update_credential()
```

**routes/tags.py (2 ä¸ª)**
```python
create_api() â†’ create_tag()
edit_api() â†’ update_tag()
```

**routes/instance.py (1 ä¸ª)**
```python
create_api() â†’ create_instance()
```

**routes/instance_detail.py (1 ä¸ª)**
```python
edit_api() â†’ update_instance()
```

**routes/logs.py (1 ä¸ª)**
```python
get_log_modules_api() â†’ get_log_modules()
```

#### ä¿®å¤è¯­æ³•é”™è¯¯ï¼ˆ2 ä¸ªï¼‰

```python
# routes/database_aggr.py
get_databases_aggregations() â†’ get_database_aggregations()
get_databases_aggregations_summary() â†’ get_database_aggregations_summary()
```

---

## ğŸ”§ æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤ 1: é‡å‘½ååç«¯æ–‡ä»¶

```bash
#!/bin/bash

# è·¯ç”±æ–‡ä»¶
git mv app/routes/database_aggr.py app/routes/database_aggregations.py
git mv app/routes/instance_aggr.py app/routes/instance_aggregations.py

# è§†å›¾æ–‡ä»¶
git mv app/views/account_classification_form_view.py app/views/classification_forms.py
git mv app/views/change_password_form_view.py app/views/password_forms.py
git mv app/views/credential_form_view.py app/views/credential_forms.py
git mv app/views/instance_form_view.py app/views/instance_forms.py
git mv app/views/scheduler_job_form_view.py app/views/scheduler_forms.py
git mv app/views/tag_form_view.py app/views/tag_forms.py
git mv app/views/user_form_view.py app/views/user_forms.py

# æœåŠ¡æ–‡ä»¶
git mv app/services/form_service/change_password_form_service.py app/services/form_service/password_service.py
git mv app/services/form_service/classification_form_service.py app/services/form_service/classification_service.py
git mv app/services/form_service/classification_rule_form_service.py app/services/form_service/classification_rule_service.py
git mv app/services/form_service/credentials_form_service.py app/services/form_service/credential_service.py
git mv app/services/form_service/instances_form_service.py app/services/form_service/instance_service.py
git mv app/services/form_service/resource_form_service.py app/services/form_service/resource_service.py
git mv app/services/form_service/scheduler_job_form_service.py app/services/form_service/scheduler_job_service.py
git mv app/services/form_service/tags_form_service.py app/services/form_service/tag_service.py
git mv app/services/form_service/users_form_service.py app/services/form_service/user_service.py

echo "âœ… åç«¯æ–‡ä»¶é‡å‘½åå®Œæˆ"
```

### æ­¥éª¤ 2: æ›´æ–°å¯¼å…¥å¼•ç”¨

```bash
#!/bin/bash

# æ›´æ–°åç«¯å¯¼å…¥ï¼ˆmacOSï¼‰
find app -name "*.py" -type f -exec sed -i '' \
  -e 's/from app\.routes\.database_aggr/from app.routes.database_aggregations/g' \
  -e 's/from app\.routes\.instance_aggr/from app.routes.instance_aggregations/g' \
  -e 's/import database_aggr/import database_aggregations/g' \
  -e 's/import instance_aggr/import instance_aggregations/g' \
  -e 's/database_aggr\./database_aggregations./g' \
  -e 's/instance_aggr\./instance_aggregations./g' \
  -e 's/from app\.views\.account_classification_form_view/from app.views.classification_forms/g' \
  -e 's/from app\.views\.change_password_form_view/from app.views.password_forms/g' \
  -e 's/from app\.views\.credential_form_view/from app.views.credential_forms/g' \
  -e 's/from app\.views\.instance_form_view/from app.views.instance_forms/g' \
  -e 's/from app\.views\.scheduler_job_form_view/from app.views.scheduler_forms/g' \
  -e 's/from app\.views\.tag_form_view/from app.views.tag_forms/g' \
  -e 's/from app\.views\.user_form_view/from app.views.user_forms/g' \
  -e 's/from app\.services\.form_service\.change_password_form_service/from app.services.form_service.password_service/g' \
  -e 's/from app\.services\.form_service\.classification_form_service/from app.services.form_service.classification_service/g' \
  -e 's/from app\.services\.form_service\.classification_rule_form_service/from app.services.form_service.classification_rule_service/g' \
  -e 's/from app\.services\.form_service\.credentials_form_service/from app.services.form_service.credential_service/g' \
  -e 's/from app\.services\.form_service\.instances_form_service/from app.services.form_service.instance_service/g' \
  -e 's/from app\.services\.form_service\.resource_form_service/from app.services.form_service.resource_service/g' \
  -e 's/from app\.services\.form_service\.scheduler_job_form_service/from app.services.form_service.scheduler_job_service/g' \
  -e 's/from app\.services\.form_service\.tags_form_service/from app.services.form_service.tag_service/g' \
  -e 's/from app\.services\.form_service\.users_form_service/from app.services.form_service.user_service/g' \
  {} +

echo "âœ… å¯¼å…¥å¼•ç”¨æ›´æ–°å®Œæˆ"
```

### æ­¥éª¤ 3: å‡½æ•°é‡å‘½åï¼ˆæ‰‹åŠ¨æ‰§è¡Œï¼‰

å‡½æ•°é‡å‘½åéœ€è¦ä½¿ç”¨ IDE çš„é‡æ„åŠŸèƒ½ï¼Œç¡®ä¿æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹ã€‚

**æ¨èå·¥å…·**: PyCharm / VS Code çš„ "Rename Symbol" åŠŸèƒ½

**æ³¨æ„äº‹é¡¹**:
1. é‡å‘½åå‡½æ•°åï¼Œéœ€è¦æ›´æ–°æ‰€æœ‰è°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹
2. éœ€è¦æ›´æ–°è·¯ç”±è£…é¥°å™¨ä¸­çš„å‡½æ•°å¼•ç”¨
3. éœ€è¦æ›´æ–°æµ‹è¯•æ–‡ä»¶ä¸­çš„å‡½æ•°è°ƒç”¨
4. å»ºè®®ä¸€æ¬¡é‡å‘½åä¸€ä¸ªæ–‡ä»¶ï¼Œå®Œæˆåç«‹å³æµ‹è¯•

---

## âœ… éªŒè¯æ¸…å•

### æ–‡ä»¶é‡å‘½åéªŒè¯

```bash
# æ£€æŸ¥æ—§æ–‡ä»¶æ˜¯å¦è¿˜å­˜åœ¨
ls app/routes/database_aggr.py 2>/dev/null && echo "âŒ æ—§æ–‡ä»¶ä»å­˜åœ¨" || echo "âœ… å·²åˆ é™¤"
ls app/routes/instance_aggr.py 2>/dev/null && echo "âŒ æ—§æ–‡ä»¶ä»å­˜åœ¨" || echo "âœ… å·²åˆ é™¤"

# æ£€æŸ¥æ–°æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls app/routes/database_aggregations.py 2>/dev/null && echo "âœ… æ–°æ–‡ä»¶å·²åˆ›å»º" || echo "âŒ æ–°æ–‡ä»¶ä¸å­˜åœ¨"
ls app/routes/instance_aggregations.py 2>/dev/null && echo "âœ… æ–°æ–‡ä»¶å·²åˆ›å»º" || echo "âŒ æ–°æ–‡ä»¶ä¸å­˜åœ¨"
```

### æœç´¢æ®‹ç•™å¼•ç”¨

```bash
# æœç´¢æ—§çš„å¯¼å…¥è·¯å¾„
rg "from app\.routes\.database_aggr" app/
rg "from app\.routes\.instance_aggr" app/
rg "from app\.views\.\w+_form_view" app/
rg "from app\.services\.form_service\.\w+_form_service" app/

# æœç´¢ api_ å‰ç¼€å‡½æ•°
rg "def api_" app/routes/

# åº”è¯¥æ²¡æœ‰ç»“æœæˆ–åªæœ‰å°‘é‡ç»“æœ
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•å¥—ä»¶
make test

# è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥
make quality

# å¯åŠ¨åº”ç”¨æ£€æŸ¥
make dev start-flask
```

---

## ğŸ“š å‘½åè§„èŒƒ

### Python

| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|-----|------|------|
| æ¨¡å— | snake_case | `user_service.py` |
| ç±» | CapWords | `UserService` |
| å‡½æ•° | snake_case | `get_user()` |
| å¸¸é‡ | UPPER_SNAKE_CASE | `MAX_SIZE` |

### RESTful API å‡½æ•°å‘½å

```python
# CRUD æ“ä½œ
def list_resources():       # GET /api/resources
def get_resource(id):       # GET /api/resources/:id
def create_resource():      # POST /api/resources
def update_resource(id):    # PUT/PATCH /api/resources/:id
def delete_resource(id):    # DELETE /api/resources/:id

# ç‰¹æ®Šæ“ä½œ
def get_statistics():       # GET /api/statistics
def search_resources():     # GET /api/resources/search
```

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

```bash
# åˆ›å»ºå¤‡ä»½
git tag backup-before-naming-$(date +%Y%m%d%H%M%S)

# å¦‚éœ€å›æ»š
git reset --hard backup-before-naming-XXXXXX
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‰ç«¯æ–‡ä»¶å·²å®Œæˆ**: å¤§éƒ¨åˆ†å‰ç«¯æ–‡ä»¶å’Œç›®å½•å·²ç»ä½¿ç”¨ kebab-caseï¼Œæ— éœ€é‡æ„
2. **å‡½æ•°é‡å‘½åé£é™©**: å‡½æ•°é‡å‘½åéœ€è¦æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹ï¼Œå»ºè®®ä½¿ç”¨ IDE é‡æ„åŠŸèƒ½
3. **åˆ†æ­¥æ‰§è¡Œ**: å»ºè®®å…ˆå®Œæˆæ–‡ä»¶é‡å‘½åï¼Œæµ‹è¯•é€šè¿‡åå†è¿›è¡Œå‡½æ•°é‡å‘½å
4. **å……åˆ†æµ‹è¯•**: æ¯ä¸ªé˜¶æ®µå®Œæˆåéƒ½è¦è¿è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶

---

*æœ€åæ›´æ–°: 2025-11-18*
