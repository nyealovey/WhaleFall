# 数据库模型与迁移一致性重构计划

## 目标
- 保证代码模型与迁移脚本一致性；在 CI 中验证从空库/旧库升级到最新。
- 规范迁移脚本命名与描述，提高可读性与回滚可控性。
- 引入数据库契约测试（schema 对比、索引/外键存在性）。

## 现状
- 模型：`app/models/*` 包含多表与索引关系。
- 迁移：`migrations/versions/*` 多次迭代，描述不一。

## 风险
- 模型与迁移偏差导致初始化/升级异常。
- 迁移命名不统一影响运维与回溯。

## 优先级与改进
- P0：在 CI 中运行 `alembic upgrade head` 并对比 schema；补充修正迁移。
- P1：命名规范与分类前缀（新增/修改/删除），完善脚本文档注释。
- P2：契约测试加入 `tests/integration/`，覆盖索引与约束。

## 产出与检查清单
- 迁移验证脚本与 CI 步骤；差异报告。
- 命名规范文档与示例；回滚策略说明。