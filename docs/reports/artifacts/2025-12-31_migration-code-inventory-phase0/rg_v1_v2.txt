scripts/ops/nginx/update-error-pages.sh:81:if curl -s -o /dev/null -w "%{http_code}" http://localhost/api/v1/health/basic 2>/dev/null | grep -q "503\|502"; then
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:22:def test_api_v1_accounts_statistics_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:23:    response = client.get("/api/v1/accounts/statistics")
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:34:def test_api_v1_accounts_statistics_endpoints_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:37:    statistics_response = auth_client.get("/api/v1/accounts/statistics")
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:47:    summary_response = auth_client.get("/api/v1/accounts/statistics/summary")
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:67:    db_types_response = auth_client.get("/api/v1/accounts/statistics/db-types")
tests/unit/routes/test_api_v1_accounts_statistics_contract.py:76:    classifications_response = auth_client.get("/api/v1/accounts/statistics/classifications")
tests/unit/test_frontend_no_legacy_api_paths.py:8:LEGACY_API_PATTERN = re.compile(r"/api(?!/v1)(?:/|$)")
scripts/dev/openapi/export_openapi.py:2:"""导出 WhaleFall `/api/v1` OpenAPI/Swagger JSON 并做最小校验.
scripts/dev/openapi/export_openapi.py:47:        default="/api/v1/openapi.json",
scripts/dev/openapi/export_openapi.py:48:        help="OpenAPI JSON 路由(默认: /api/v1/openapi.json)",
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:17:def test_api_v1_accounts_ledgers_contract() -> None:
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:88:        response = client.get("/api/v1/accounts/ledgers")
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:127:def test_api_v1_accounts_ledgers_permissions_contract() -> None:
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:201:        response = client.get(f"/api/v1/accounts/ledgers/{permission.id}/permissions")
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:215:def test_api_v1_accounts_ledgers_requires_auth(client):
tests/unit/routes/test_api_v1_accounts_ledgers_contract.py:216:    response = client.get("/api/v1/accounts/ledgers")
tests/unit/routes/test_api_v1_capacity_databases_contract.py:25:def test_api_v1_capacity_databases_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_capacity_databases_contract.py:27:        "/api/v1/capacity/databases?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_databases_contract.py:35:        "/api/v1/capacity/databases/summary?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_databases_contract.py:44:def test_api_v1_capacity_databases_endpoints_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_capacity_databases_contract.py:88:        "/api/v1/capacity/databases?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_databases_contract.py:117:        "/api/v1/capacity/databases/summary?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
scripts/deploy/deploy-prod-all.sh:3:# 鲸落项目生产环境部署脚本 v1.3.6
scripts/deploy/deploy-prod-all.sh:39:# 严格验证 /api/v1/health/health 响应是否健康（避免 grep "healthy" 匹配到 "unhealthy"）
scripts/deploy/deploy-prod-all.sh:440:        if curl -f http://localhost/api/v1/health/basic > /dev/null 2>&1; then
scripts/deploy/deploy-prod-all.sh:605:    flask_response=$(docker compose -f docker-compose.prod.yml exec -T whalefall curl -s http://localhost:5001/api/v1/health/health 2>/dev/null)
scripts/deploy/deploy-prod-all.sh:678:    nginx_health_response=$(curl -s http://localhost/api/v1/health/basic 2>/dev/null)
scripts/deploy/deploy-prod-all.sh:729:        if curl -f http://localhost/api/v1/health/basic > /dev/null 2>&1; then
scripts/deploy/deploy-prod-all.sh:769:    db_test_response=$(curl -s http://localhost/api/v1/health/health 2>/dev/null)
scripts/deploy/deploy-prod-all.sh:781:        flask_response=$(curl -s http://localhost:5001/api/v1/health/health 2>/dev/null)
scripts/deploy/deploy-prod-all.sh:807:    health_response=$(curl -s http://localhost:5001/api/v1/health/health)
scripts/deploy/deploy-prod-all.sh:843:    echo "  - 健康检查: http://localhost/api/v1/health/basic"
scripts/deploy/deploy-prod-all.sh:871:    log_info "开始部署鲸落项目生产环境 v1.3.6..."
scripts/dev/sync-local-code-to-docker.sh:216:    check "/api/v1/health/basic"
scripts/dev/sync-local-code-to-docker.sh:217:    check "/api/v1/openapi.json"
scripts/dev/sync-local-code-to-docker.sh:218:    check "/api/v1/health/ping"
scripts/dev/sync-local-code-to-docker.sh:219:    check "/api/v1/"
tests/unit/routes/test_api_v1_health_extended_contract.py:5:def test_api_v1_health_cache_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_health_extended_contract.py:6:    response = client.get("/api/v1/health/cache")
tests/unit/routes/test_api_v1_health_extended_contract.py:14:def test_api_v1_health_cache_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_health_extended_contract.py:15:    import app.api.v1.namespaces.health as api_module
tests/unit/routes/test_api_v1_health_extended_contract.py:24:    response = auth_client.get("/api/v1/health/cache")
tests/unit/routes/test_api_v1_health_extended_contract.py:35:def test_api_v1_health_detailed_contract(client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_health_extended_contract.py:36:    import app.api.v1.namespaces.health as api_module
tests/unit/routes/test_api_v1_health_extended_contract.py:42:    response = client.get("/api/v1/health/detailed")
scripts/deploy/update-prod-flask.sh:468:    if curl --noproxy localhost -f http://localhost:5001/api/v1/health/health > /dev/null 2>&1; then
scripts/deploy/update-prod-flask.sh:472:        log_info "端口5001状态码: $(curl --noproxy localhost -s -o /dev/null -w '%{http_code}' http://localhost:5001/api/v1/health/health 2>/dev/null)"
scripts/deploy/update-prod-flask.sh:529:        if curl -f http://localhost/api/v1/health/basic > /dev/null 2>&1; then
scripts/deploy/update-prod-flask.sh:583:    http_status=$(curl --noproxy localhost -s -o /dev/null -w '%{http_code}' http://localhost:5001/api/v1/health/health 2>/dev/null)
scripts/deploy/update-prod-flask.sh:627:    echo "  - 健康检查: http://localhost/api/v1/health/basic"
scripts/deploy/update-prod-flask.sh:643:    echo "  - 健康状态: curl http://localhost:5001/api/v1/health/health"
tests/unit/routes/test_api_v1_tags_bulk_contract.py:9:def test_api_v1_tags_bulk_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_tags_bulk_contract.py:10:    response = client.get("/api/v1/tags/bulk/instances")
tests/unit/routes/test_api_v1_tags_bulk_contract.py:16:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_bulk_contract.py:25:        "/api/v1/tags/bulk/assign",
tests/unit/routes/test_api_v1_tags_bulk_contract.py:36:def test_api_v1_tags_bulk_endpoints_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_tags_bulk_contract.py:70:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_bulk_contract.py:78:    instances_response = auth_client.get("/api/v1/tags/bulk/instances")
tests/unit/routes/test_api_v1_tags_bulk_contract.py:87:    tags_response = auth_client.get("/api/v1/tags/bulk/tags")
tests/unit/routes/test_api_v1_tags_bulk_contract.py:97:        "/api/v1/tags/bulk/assign",
tests/unit/routes/test_api_v1_tags_bulk_contract.py:107:        "/api/v1/tags/bulk/instance-tags",
tests/unit/routes/test_api_v1_tags_bulk_contract.py:117:        "/api/v1/tags/bulk/remove",
tests/unit/routes/test_api_v1_tags_bulk_contract.py:127:        "/api/v1/tags/bulk/remove-all",
scripts/deploy/deploy-prod-flask.sh:101:        if curl --noproxy localhost,127.0.0.1,::1 -f http://localhost/api/v1/health/basic > /dev/null 2>&1; then
scripts/deploy/deploy-prod-flask.sh:125:    echo "  - 健康检查: http://localhost/api/v1/health/basic"
tests/unit/routes/test_api_v1_connections_contract.py:13:    response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_connections_contract.py:23:def test_api_v1_connections_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:24:    response = client.get("/api/v1/connections/status/1")
tests/unit/routes/test_api_v1_connections_contract.py:35:def test_api_v1_connections_validate_params_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:56:        "/api/v1/connections/actions/validate-params",
tests/unit/routes/test_api_v1_connections_contract.py:73:def test_api_v1_connections_batch_test_contract(auth_client) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:76:        "/api/v1/connections/actions/batch-test",
tests/unit/routes/test_api_v1_connections_contract.py:105:def test_api_v1_connections_status_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:126:    response = auth_client.get(f"/api/v1/connections/status/{instance_id}")
tests/unit/routes/test_api_v1_connections_contract.py:149:def test_api_v1_connections_test_connection_missing_payload_contract(auth_client) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:152:        "/api/v1/connections/actions/test",
tests/unit/routes/test_api_v1_connections_contract.py:166:def test_api_v1_connections_test_connection_failure_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:197:        "/api/v1/connections/actions/test",
tests/unit/routes/test_api_v1_connections_contract.py:216:def test_api_v1_connections_test_connection_success_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_connections_contract.py:242:        "/api/v1/connections/actions/test",
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:33:def test_api_v1_instances_sync_capacity_requires_auth(app, client) -> None:
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:36:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:44:        "/api/v1/instances/1/actions/sync-capacity",
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:54:def test_api_v1_instances_sync_capacity_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:114:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:122:        f"/api/v1/instances/{instance_id}/actions/sync-capacity",
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:141:def test_api_v1_instances_sync_capacity_failure_keeps_inventory(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:179:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:187:        f"/api/v1/instances/{instance_id}/actions/sync-capacity",
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:203:def test_api_v1_instances_sync_capacity_exception_returns_sync_error_and_keeps_inventory(
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:246:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:254:        f"/api/v1/instances/{instance_id}/actions/sync-capacity",
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:271:def test_api_v1_instances_sync_capacity_connect_failure_returns_connection_error(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:301:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_sync_capacity_contract.py:309:        f"/api/v1/instances/{instance_id}/actions/sync-capacity",
tests/unit/routes/test_api_v1_admin_contract.py:5:def test_api_v1_admin_app_info_contract(client) -> None:
tests/unit/routes/test_api_v1_admin_contract.py:6:    response = client.get("/api/v1/admin/app-info")
tests/unit/routes/test_api_v1_swagger_contract.py:5:def test_api_v1_swagger_json_renders(client) -> None:
tests/unit/routes/test_api_v1_swagger_contract.py:6:    response = client.get("/api/v1/swagger.json")
tests/unit/routes/test_api_v1_instances_statistics_contract.py:5:def test_api_v1_instances_statistics_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_instances_statistics_contract.py:6:    response = client.get("/api/v1/instances/statistics")
tests/unit/routes/test_api_v1_instances_statistics_contract.py:14:def test_api_v1_instances_statistics_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_instances_statistics_contract.py:15:    import app.api.v1.namespaces.instances as api_module
tests/unit/routes/test_api_v1_instances_statistics_contract.py:33:    response = auth_client.get("/api/v1/instances/statistics")
tests/unit/routes/test_api_v1_scheduler_contract.py:10:def test_api_v1_scheduler_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_scheduler_contract.py:11:    response = client.get("/api/v1/scheduler/jobs")
tests/unit/routes/test_api_v1_scheduler_contract.py:17:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_scheduler_contract.py:25:    reload_response = client.post("/api/v1/scheduler/jobs/reload", json={}, headers=headers)
tests/unit/routes/test_api_v1_scheduler_contract.py:33:def test_api_v1_scheduler_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_scheduler_contract.py:110:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_scheduler_contract.py:118:    list_response = auth_client.get("/api/v1/scheduler/jobs")
tests/unit/routes/test_api_v1_scheduler_contract.py:126:    detail_response = auth_client.get("/api/v1/scheduler/jobs/job-1")
tests/unit/routes/test_api_v1_scheduler_contract.py:136:        "/api/v1/scheduler/jobs/job-1",
tests/unit/routes/test_api_v1_scheduler_contract.py:145:    pause_response = auth_client.post("/api/v1/scheduler/jobs/job-1/pause", json={}, headers=headers)
tests/unit/routes/test_api_v1_scheduler_contract.py:151:    resume_response = auth_client.post("/api/v1/scheduler/jobs/job-1/resume", json={}, headers=headers)
tests/unit/routes/test_api_v1_scheduler_contract.py:157:    run_response = auth_client.post("/api/v1/scheduler/jobs/job-1/run", json={}, headers=headers)
tests/unit/routes/test_api_v1_scheduler_contract.py:166:    reload_response = auth_client.post("/api/v1/scheduler/jobs/reload", json={}, headers=headers)
app/settings.py:79:DEFAULT_API_V1_DOCS_ENABLED = True
app/settings.py:433:    - `/api/v1/**` 始终启用
app/settings.py:436:    docs_default = DEFAULT_API_V1_DOCS_ENABLED
app/settings.py:439:    return _parse_bool(os.environ.get("API_V1_DOCS_ENABLED"), default=docs_default)
app/settings.py:540:    api_v1_docs_enabled: bool
app/settings.py:627:            "API_V1_DOCS_ENABLED": self.api_v1_docs_enabled,
app/settings.py:708:        api_v1_docs_enabled = _load_api_settings(environment_normalized)
app/settings.py:774:            api_v1_docs_enabled=api_v1_docs_enabled,
tests/unit/routes/test_api_v1_capacity_instances_contract.py:77:def test_api_v1_capacity_instances_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_capacity_instances_contract.py:79:        "/api/v1/capacity/instances?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_instances_contract.py:87:        "/api/v1/capacity/instances/summary?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_instances_contract.py:96:def test_api_v1_capacity_instances_endpoints_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_capacity_instances_contract.py:148:        "/api/v1/capacity/instances?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_instances_contract.py:180:        "/api/v1/capacity/instances/summary?period_type=daily&start_date=2025-12-24&end_date=2025-12-24",
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:7:def test_api_v1_capacity_current_aggregation_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:8:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:16:        "/api/v1/capacity/aggregations/current",
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:27:def test_api_v1_capacity_current_aggregation_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:46:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_capacity_aggregations_contract.py:54:        "/api/v1/capacity/aggregations/current",
tests/unit/routes/test_api_v1_tags_contract.py:11:def test_api_v1_tags_list_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:43:        response = client.get("/api/v1/tags")
tests/unit/routes/test_api_v1_tags_contract.py:85:def test_api_v1_tags_options_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:115:        response = client.get("/api/v1/tags/options")
tests/unit/routes/test_api_v1_tags_contract.py:130:def test_api_v1_tags_categories_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:160:        response = client.get("/api/v1/tags/categories")
tests/unit/routes/test_api_v1_tags_contract.py:174:def test_api_v1_tag_detail_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:204:        response = client.get(f"/api/v1/tags/{tag.id}")
tests/unit/routes/test_api_v1_tags_contract.py:221:def test_api_v1_tags_get_by_name_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:251:        response = client.get(f"/api/v1/tags/by-name/{tag.name}")
tests/unit/routes/test_api_v1_tags_contract.py:268:def test_api_v1_tags_requires_auth(client):
tests/unit/routes/test_api_v1_tags_contract.py:269:    response = client.get("/api/v1/tags")
tests/unit/routes/test_api_v1_tags_contract.py:280:def test_api_v1_tags_create_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:301:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_contract.py:309:            "/api/v1/tags",
tests/unit/routes/test_api_v1_tags_contract.py:334:def test_api_v1_tags_update_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:364:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_contract.py:372:            f"/api/v1/tags/{tag.id}",
tests/unit/routes/test_api_v1_tags_contract.py:398:def test_api_v1_tags_delete_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:430:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_contract.py:438:            f"/api/v1/tags/{tag.id}/delete",
tests/unit/routes/test_api_v1_tags_contract.py:455:def test_api_v1_tags_delete_in_use_returns_conflict() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:501:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_contract.py:509:            f"/api/v1/tags/{tag.id}/delete",
tests/unit/routes/test_api_v1_tags_contract.py:523:def test_api_v1_tags_batch_delete_contract() -> None:
tests/unit/routes/test_api_v1_tags_contract.py:563:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_tags_contract.py:571:            "/api/v1/tags/batch-delete",
tests/unit/routes/test_api_v1_dashboard_contract.py:26:def test_api_v1_dashboard_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:27:    response = client.get("/api/v1/dashboard/overview")
tests/unit/routes/test_api_v1_dashboard_contract.py:38:def test_api_v1_dashboard_overview_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:41:    response = auth_client.get("/api/v1/dashboard/overview")
tests/unit/routes/test_api_v1_dashboard_contract.py:55:def test_api_v1_dashboard_status_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:58:    response = auth_client.get("/api/v1/dashboard/status")
tests/unit/routes/test_api_v1_dashboard_contract.py:71:def test_api_v1_dashboard_activities_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:74:    response = auth_client.get("/api/v1/dashboard/activities")
tests/unit/routes/test_api_v1_dashboard_contract.py:87:def test_api_v1_dashboard_charts_logs_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:90:    response = auth_client.get("/api/v1/dashboard/charts?type=logs")
tests/unit/routes/test_api_v1_dashboard_contract.py:104:def test_api_v1_dashboard_charts_syncs_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:107:    response = auth_client.get("/api/v1/dashboard/charts?type=syncs")
tests/unit/routes/test_api_v1_dashboard_contract.py:128:def test_api_v1_dashboard_charts_unknown_type_returns_empty_dict(auth_client) -> None:
tests/unit/routes/test_api_v1_dashboard_contract.py:129:    response = auth_client.get("/api/v1/dashboard/charts?type=unknown")
tests/unit/routes/test_api_v1_partition_contract.py:16:def test_api_v1_partition_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_partition_contract.py:17:    response = client.get("/api/v1/partition/info")
tests/unit/routes/test_api_v1_partition_contract.py:23:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_partition_contract.py:31:    create_response = client.post("/api/v1/partition/create", json={"date": "2099-12-27"}, headers=headers)
tests/unit/routes/test_api_v1_partition_contract.py:39:def test_api_v1_partition_endpoints_contract(auth_client, monkeypatch) -> None:  # noqa: PLR0915
tests/unit/routes/test_api_v1_partition_contract.py:130:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_partition_contract.py:138:    info_response = auth_client.get("/api/v1/partition/info")
tests/unit/routes/test_api_v1_partition_contract.py:144:    status_response = auth_client.get("/api/v1/partition/status")
tests/unit/routes/test_api_v1_partition_contract.py:150:    list_response = auth_client.get("/api/v1/partition/partitions")
tests/unit/routes/test_api_v1_partition_contract.py:159:    statistics_response = auth_client.get("/api/v1/partition/statistics")
tests/unit/routes/test_api_v1_partition_contract.py:165:    core_metrics_response = auth_client.get("/api/v1/partition/aggregations/core-metrics")
tests/unit/routes/test_api_v1_partition_contract.py:171:    create_response = auth_client.post("/api/v1/partition/create", json={"date": "2099-12-27"}, headers=headers)
tests/unit/routes/test_api_v1_partition_contract.py:177:    cleanup_response = auth_client.post("/api/v1/partition/cleanup", json={"retention_months": 12}, headers=headers)
tests/unit/routes/test_api_v1_instances_contract.py:16:def test_api_v1_instances_list_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:52:        response = client.get("/api/v1/instances")
tests/unit/routes/test_api_v1_instances_contract.py:93:def test_api_v1_instances_detail_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:126:        response = client.get(f"/api/v1/instances/{instance.id}")
tests/unit/routes/test_api_v1_instances_contract.py:144:def test_api_v1_instances_requires_auth(client):
tests/unit/routes/test_api_v1_instances_contract.py:145:    response = client.get("/api/v1/instances")
tests/unit/routes/test_api_v1_instances_contract.py:156:def test_api_v1_instances_create_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:179:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_contract.py:187:            "/api/v1/instances",
tests/unit/routes/test_api_v1_instances_contract.py:213:def test_api_v1_instances_update_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:246:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_contract.py:254:            f"/api/v1/instances/{instance.id}",
tests/unit/routes/test_api_v1_instances_contract.py:281:def test_api_v1_instances_soft_delete_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:314:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_contract.py:322:            f"/api/v1/instances/{instance.id}/delete",
tests/unit/routes/test_api_v1_instances_contract.py:340:def test_api_v1_instances_restore_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:373:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_contract.py:381:            f"/api/v1/instances/{instance.id}/delete",
tests/unit/routes/test_api_v1_instances_contract.py:388:            f"/api/v1/instances/{instance.id}/restore",
tests/unit/routes/test_api_v1_instances_contract.py:407:def test_api_v1_instances_accounts_list_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:480:        response = client.get(f"/api/v1/instances/{instance.id}/accounts")
tests/unit/routes/test_api_v1_instances_contract.py:498:def test_api_v1_instances_account_permissions_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:572:            f"/api/v1/instances/{instance.id}/accounts/{account_permission.id}/permissions",
tests/unit/routes/test_api_v1_instances_contract.py:587:def test_api_v1_instances_account_change_history_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:665:            f"/api/v1/instances/{instance.id}/accounts/{account_permission.id}/change-history",
tests/unit/routes/test_api_v1_instances_contract.py:683:def test_api_v1_instances_database_sizes_contract() -> None:
tests/unit/routes/test_api_v1_instances_contract.py:726:        response = client.get(f"/api/v1/instances/{instance.id}/databases/sizes")
tests/unit/routes/test_api_v1_cache_contract.py:10:def test_api_v1_cache_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_cache_contract.py:11:    response = client.get("/api/v1/cache/stats")
tests/unit/routes/test_api_v1_cache_contract.py:17:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_cache_contract.py:25:    clear_all_response = client.post("/api/v1/cache/clear/all", json={}, headers=headers)
tests/unit/routes/test_api_v1_cache_contract.py:33:def test_api_v1_cache_endpoints_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_cache_contract.py:77:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_cache_contract.py:85:    stats_response = auth_client.get("/api/v1/cache/stats")
tests/unit/routes/test_api_v1_cache_contract.py:94:    classification_stats_response = auth_client.get("/api/v1/cache/classification/stats")
tests/unit/routes/test_api_v1_cache_contract.py:104:        "/api/v1/cache/clear/user",
tests/unit/routes/test_api_v1_cache_contract.py:114:        "/api/v1/cache/clear/instance",
tests/unit/routes/test_api_v1_cache_contract.py:124:        "/api/v1/cache/clear/all",
tests/unit/routes/test_api_v1_cache_contract.py:137:        "/api/v1/cache/classification/clear",
tests/unit/routes/test_api_v1_cache_contract.py:147:        "/api/v1/cache/classification/clear/mysql",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:30:def test_api_v1_accounts_classifications_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:31:    response = client.get("/api/v1/accounts/classifications")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:41:def test_api_v1_accounts_classifications_auto_classify_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:57:    import app.api.v1.namespaces.accounts_classifications as api_module
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:61:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:69:        "/api/v1/accounts/classifications/actions/auto-classify",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:84:def test_api_v1_accounts_classifications_endpoints_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:139:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:147:    colors_response = auth_client.get("/api/v1/accounts/classifications/colors")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:156:    classifications_response = auth_client.get("/api/v1/accounts/classifications")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:166:        "/api/v1/accounts/classifications",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:186:    detail_response = auth_client.get(f"/api/v1/accounts/classifications/{classification_id}")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:196:        f"/api/v1/accounts/classifications/{classification_id}",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:205:    rules_response = auth_client.get("/api/v1/accounts/classifications/rules")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:215:        "/api/v1/accounts/classifications/rules",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:233:    rule_detail_response = auth_client.get(f"/api/v1/accounts/classifications/rules/{rule_id}")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:243:        f"/api/v1/accounts/classifications/rules/{rule_id}",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:260:        f"/api/v1/accounts/classifications/rules/filter?classification_id={classification_id}&db_type=mysql",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:283:    assignments_response = auth_client.get("/api/v1/accounts/classifications/assignments")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:292:    stats_response = auth_client.get(f"/api/v1/accounts/classifications/rules/stats?rule_ids={rule_id}")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:302:        f"/api/v1/accounts/classifications/assignments/{assignment_id}",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:307:    permissions_response = auth_client.get("/api/v1/accounts/classifications/permissions/mysql")
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:328:        f"/api/v1/accounts/classifications/rules/{rule_id}",
tests/unit/routes/test_api_v1_accounts_classifications_contract.py:334:        f"/api/v1/accounts/classifications/{classification_id}",
tests/unit/routes/test_api_v1_credentials_contract.py:10:def test_api_v1_credentials_list_contract() -> None:
tests/unit/routes/test_api_v1_credentials_contract.py:54:        response = client.get("/api/v1/credentials")
tests/unit/routes/test_api_v1_credentials_contract.py:93:def test_api_v1_credential_detail_contract() -> None:
tests/unit/routes/test_api_v1_credentials_contract.py:126:        response = client.get(f"/api/v1/credentials/{credential.id}")
tests/unit/routes/test_api_v1_credentials_contract.py:143:def test_api_v1_credentials_requires_auth(client):
tests/unit/routes/test_api_v1_credentials_contract.py:144:    response = client.get("/api/v1/credentials")
tests/unit/routes/test_api_v1_credentials_contract.py:155:def test_api_v1_credentials_create_contract() -> None:
tests/unit/routes/test_api_v1_credentials_contract.py:177:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_credentials_contract.py:185:            "/api/v1/credentials",
tests/unit/routes/test_api_v1_credentials_contract.py:212:def test_api_v1_credentials_update_contract() -> None:
tests/unit/routes/test_api_v1_credentials_contract.py:244:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_credentials_contract.py:252:            f"/api/v1/credentials/{credential.id}",
tests/unit/routes/test_api_v1_credentials_contract.py:279:def test_api_v1_credentials_delete_contract() -> None:
tests/unit/routes/test_api_v1_credentials_contract.py:312:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_credentials_contract.py:320:            f"/api/v1/credentials/{credential.id}/delete",
tests/unit/routes/test_api_v1_instances_batch_contract.py:9:def test_api_v1_instances_batch_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_instances_batch_contract.py:10:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_batch_contract.py:19:        "/api/v1/instances/batch-delete",
tests/unit/routes/test_api_v1_instances_batch_contract.py:30:        "/api/v1/instances/batch-create",
tests/unit/routes/test_api_v1_instances_batch_contract.py:42:def test_api_v1_instances_batch_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_instances_batch_contract.py:60:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_instances_batch_contract.py:70:        "/api/v1/instances/batch-create",
tests/unit/routes/test_api_v1_instances_batch_contract.py:84:        "/api/v1/instances/batch-delete",
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:7:def test_api_v1_databases_ledgers_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:8:    response = client.get("/api/v1/databases/ledgers")
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:14:    response = client.get("/api/v1/databases/ledgers/1/capacity-trend")
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:22:def test_api_v1_databases_ledgers_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:67:    response = auth_client.get("/api/v1/databases/ledgers?db_type=all&page=1&limit=20&search=db")
tests/unit/routes/test_api_v1_databases_ledgers_contract.py:91:    response = auth_client.get("/api/v1/databases/ledgers/1/capacity-trend?days=7")
tests/unit/routes/test_api_v1_files_contract.py:7:def test_api_v1_files_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_files_contract.py:8:    response = client.get("/api/v1/files/account-export")
tests/unit/routes/test_api_v1_files_contract.py:14:    response = client.get("/api/v1/files/template-download")
tests/unit/routes/test_api_v1_files_contract.py:20:    response = client.get("/api/v1/files/log-export")
tests/unit/routes/test_api_v1_files_contract.py:28:def test_api_v1_files_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_files_contract.py:52:    import app.api.v1.namespaces.files as api_module
tests/unit/routes/test_api_v1_files_contract.py:59:    response = auth_client.get("/api/v1/files/account-export")
tests/unit/routes/test_api_v1_files_contract.py:64:    response = auth_client.get("/api/v1/files/instance-export")
tests/unit/routes/test_api_v1_files_contract.py:68:    response = auth_client.get("/api/v1/files/database-ledger-export")
tests/unit/routes/test_api_v1_files_contract.py:72:    response = auth_client.get("/api/v1/files/template-download")
tests/unit/routes/test_api_v1_files_contract.py:76:    response = auth_client.get("/api/v1/files/log-export?format=json")
tests/unit/routes/test_api_v1_files_contract.py:81:    response = auth_client.get("/api/v1/files/log-export?format=csv")
tests/unit/routes/test_form_service_message_key_contract.py:30:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_form_service_message_key_contract.py:39:            "/api/v1/accounts/classifications",
tests/unit/routes/test_form_service_message_key_contract.py:46:            "/api/v1/accounts/classifications",
tests/unit/routes/test_form_service_message_key_contract.py:77:        csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_form_service_message_key_contract.py:84:            "/api/v1/auth/change-password",
tests/unit/routes/test_api_v1_health_ping_contract.py:1:# tests/unit/routes/test_api_v1_health_ping_contract.py
tests/unit/routes/test_api_v1_health_ping_contract.py:2:"""API v1 health contract tests."""
tests/unit/routes/test_api_v1_health_ping_contract.py:8:def test_api_v1_health_ping_returns_success_envelope(client):
tests/unit/routes/test_api_v1_health_ping_contract.py:9:    response = client.get("/api/v1/health/ping")
tests/unit/routes/test_api_v1_health_ping_contract.py:21:def test_api_v1_health_basic_returns_success_envelope(client):
tests/unit/routes/test_api_v1_health_ping_contract.py:22:    response = client.get("/api/v1/health/basic")
tests/unit/routes/test_api_v1_health_ping_contract.py:39:def test_api_v1_health_health_returns_success_envelope(client):
tests/unit/routes/test_api_v1_health_ping_contract.py:40:    response = client.get("/api/v1/health/health")
tests/unit/routes/test_api_v1_health_ping_contract.py:55:def test_api_v1_health_unknown_path_returns_error_envelope(client):
tests/unit/routes/test_api_v1_health_ping_contract.py:56:    response = client.get("/api/v1/health/does-not-exist")
tests/unit/routes/test_api_v1_accounts_sync_contract.py:19:def test_api_v1_accounts_sync_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_accounts_sync_contract.py:20:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_accounts_sync_contract.py:28:    response = client.post("/api/v1/accounts/actions/sync-all", headers=headers)
tests/unit/routes/test_api_v1_accounts_sync_contract.py:34:    response = client.post("/api/v1/accounts/actions/sync", json={"instance_id": 1}, headers=headers)
tests/unit/routes/test_api_v1_accounts_sync_contract.py:42:def test_api_v1_accounts_sync_endpoints_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_accounts_sync_contract.py:73:    import app.api.v1.namespaces.accounts as api_module
tests/unit/routes/test_api_v1_accounts_sync_contract.py:78:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_accounts_sync_contract.py:86:    sync_all_response = auth_client.post("/api/v1/accounts/actions/sync-all", headers=headers)
tests/unit/routes/test_api_v1_accounts_sync_contract.py:96:        "/api/v1/accounts/actions/sync",
tests/unit/routes/test_api_v1_accounts_sync_contract.py:112:def test_api_v1_accounts_sync_failure_contract(app, auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_accounts_sync_contract.py:133:    import app.api.v1.namespaces.accounts as api_module
tests/unit/routes/test_api_v1_accounts_sync_contract.py:137:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_accounts_sync_contract.py:146:        "/api/v1/accounts/actions/sync",
tests/unit/routes/test_api_v1_common_options_contract.py:9:def test_api_v1_common_instances_options_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_common_options_contract.py:28:    response = auth_client.get("/api/v1/common/instances/options")
tests/unit/routes/test_api_v1_common_options_contract.py:49:    filtered = auth_client.get("/api/v1/common/instances/options?db_type=MYSQL")
tests/unit/routes/test_api_v1_common_options_contract.py:54:def test_api_v1_common_databases_options_contract(app, auth_client) -> None:
tests/unit/routes/test_api_v1_common_options_contract.py:80:    response = auth_client.get(f"/api/v1/common/databases/options?instance_id={instance_id}&limit=100&offset=0")
tests/unit/routes/test_api_v1_common_options_contract.py:111:def test_api_v1_common_database_types_options_contract(auth_client) -> None:
tests/unit/routes/test_api_v1_common_options_contract.py:112:    response = auth_client.get("/api/v1/common/database-types/options")
tests/unit/routes/test_api_v1_users_contract.py:5:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_users_contract.py:15:def test_api_v1_users_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_users_contract.py:19:    response = client.get("/api/v1/users")
tests/unit/routes/test_api_v1_users_contract.py:25:    response = client.get("/api/v1/users/stats")
tests/unit/routes/test_api_v1_users_contract.py:32:        "/api/v1/users",
tests/unit/routes/test_api_v1_users_contract.py:42:        "/api/v1/users/1",
tests/unit/routes/test_api_v1_users_contract.py:51:    response = client.delete("/api/v1/users/1", headers=headers)
tests/unit/routes/test_api_v1_users_contract.py:59:def test_api_v1_users_endpoints_contract(auth_client) -> None:
tests/unit/routes/test_api_v1_users_contract.py:63:    list_response = auth_client.get("/api/v1/users")
tests/unit/routes/test_api_v1_users_contract.py:73:        "/api/v1/users",
tests/unit/routes/test_api_v1_users_contract.py:88:    detail_response = auth_client.get(f"/api/v1/users/{user_id}")
tests/unit/routes/test_api_v1_users_contract.py:95:        f"/api/v1/users/{user_id}",
tests/unit/routes/test_api_v1_users_contract.py:104:    stats_response = auth_client.get("/api/v1/users/stats")
tests/unit/routes/test_api_v1_users_contract.py:113:    delete_response = auth_client.delete(f"/api/v1/users/{user_id}", headers=headers)
tests/unit/routes/test_api_v1_history_logs_contract.py:10:def test_api_v1_history_logs_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_history_logs_contract.py:11:    response = client.get("/api/v1/history/logs/list")
tests/unit/routes/test_api_v1_history_logs_contract.py:17:    response = client.get("/api/v1/history/logs/statistics")
tests/unit/routes/test_api_v1_history_logs_contract.py:25:def test_api_v1_history_logs_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_history_logs_contract.py:83:    list_response = auth_client.get("/api/v1/history/logs/list")
tests/unit/routes/test_api_v1_history_logs_contract.py:92:    search_response = auth_client.get("/api/v1/history/logs/search")
tests/unit/routes/test_api_v1_history_logs_contract.py:98:    modules_response = auth_client.get("/api/v1/history/logs/modules")
tests/unit/routes/test_api_v1_history_logs_contract.py:107:    stats_response = auth_client.get("/api/v1/history/logs/statistics")
tests/unit/routes/test_api_v1_history_logs_contract.py:116:    detail_response = auth_client.get("/api/v1/history/logs/detail/1")
tests/unit/routes/test_api_v1_auth_contract.py:9:    response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_auth_contract.py:19:def test_api_v1_auth_csrf_token_contract(client) -> None:
tests/unit/routes/test_api_v1_auth_contract.py:20:    response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_auth_contract.py:34:def test_api_v1_auth_login_me_refresh_logout_contract(app, client) -> None:
tests/unit/routes/test_api_v1_auth_contract.py:47:            "/api/v1/auth/login",
tests/unit/routes/test_api_v1_auth_contract.py:70:            "/api/v1/auth/me",
tests/unit/routes/test_api_v1_auth_contract.py:85:            "/api/v1/auth/refresh",
tests/unit/routes/test_api_v1_auth_contract.py:104:            "/api/v1/auth/logout",
tests/unit/routes/test_api_v1_auth_contract.py:116:def test_api_v1_auth_change_password_invalid_old_password_contract(app, client) -> None:
tests/unit/routes/test_api_v1_auth_contract.py:128:            "/api/v1/auth/login",
tests/unit/routes/test_api_v1_auth_contract.py:136:            "/api/v1/auth/change-password",
tests/unit/routes/test_api_v1_history_sessions_contract.py:16:def test_api_v1_history_sessions_requires_auth(client) -> None:
tests/unit/routes/test_api_v1_history_sessions_contract.py:17:    response = client.get("/api/v1/history/sessions")
tests/unit/routes/test_api_v1_history_sessions_contract.py:23:    csrf_response = client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_history_sessions_contract.py:31:    cancel_response = client.post("/api/v1/history/sessions/s-1/cancel", json={}, headers=headers)
tests/unit/routes/test_api_v1_history_sessions_contract.py:39:def test_api_v1_history_sessions_endpoints_contract(auth_client, monkeypatch) -> None:
tests/unit/routes/test_api_v1_history_sessions_contract.py:128:    csrf_response = auth_client.get("/api/v1/auth/csrf-token")
tests/unit/routes/test_api_v1_history_sessions_contract.py:136:    list_response = auth_client.get("/api/v1/history/sessions")
tests/unit/routes/test_api_v1_history_sessions_contract.py:145:    detail_response = auth_client.get("/api/v1/history/sessions/s-1")
tests/unit/routes/test_api_v1_history_sessions_contract.py:151:    errors_response = auth_client.get("/api/v1/history/sessions/s-1/error-logs")
tests/unit/routes/test_api_v1_history_sessions_contract.py:157:    cancel_response = auth_client.post("/api/v1/history/sessions/s-1/cancel", json={}, headers=headers)
app/static/js/modules/services/sync_sessions_service.js:4:  const BASE_PATH = "/api/v1/history/sessions";
app/static/js/modules/services/partition_service.js:4:  const BASE_PATH = "/api/v1/partition";
app/static/js/modules/services/partition_service.js:123:      return this.httpClient.get("/api/v1/health/health");
app/static/js/modules/services/logs_service.js:4:  const BASE_PATH = "/api/v1/history/logs";
app/static/js/modules/services/connection_service.js:4:  const BASE_PATH = "/api/v1/connections";
app/static/js/modules/services/permission_service.js:48:      return this.httpClient.get(`/api/v1/accounts/ledgers/${accountId}/permissions`);
app/static/js/modules/services/permission_service.js:67:        `/api/v1/instances/${instanceId}/accounts/${accountId}/permissions`,
app/static/js/modules/services/user_service.js:4:  const BASE_PATH = "/api/v1/users";
app/static/js/modules/services/credentials_service.js:4:  const BASE_PATH = "/api/v1/credentials";
app/static/js/modules/services/account_classification_service.js:4:  const BASE_PATH = "/api/v1/accounts/classifications";
app/static/js/modules/services/database_ledger_service.js:66:      return this.httpClient.get(`/api/v1/databases/ledgers${query}`);
app/static/js/modules/services/database_ledger_service.js:75:        `/api/v1/databases/ledgers/${databaseId}/capacity-trend${query}`,
app/static/js/modules/views/credentials/list.js:132:          url: "/api/v1/credentials?sort=id&order=desc",
app/static/js/modules/services/scheduler_service.js:4:  const BASE_PATH = "/api/v1/scheduler";
app/static/js/modules/services/dashboard_service.js:45:      return this.httpClient.get(`/api/v1/dashboard/charts${query}`);
app/static/js/modules/services/tag_management_service.js:5:    tags: "/api/v1/tags/options",
app/static/js/modules/services/tag_management_service.js:6:    categories: "/api/v1/tags/categories",
app/static/js/modules/services/tag_management_service.js:7:    instances: "/api/v1/tags/bulk/instances",
app/static/js/modules/services/tag_management_service.js:8:    allTags: "/api/v1/tags/bulk/tags",
app/static/js/modules/services/tag_management_service.js:9:    batchAssign: "/api/v1/tags/bulk/assign",
app/static/js/modules/services/tag_management_service.js:10:    batchRemoveAll: "/api/v1/tags/bulk/remove-all",
app/static/js/modules/services/tag_management_service.js:11:    batchDelete: "/api/v1/tags/batch-delete",
app/static/js/modules/services/tag_management_service.js:172:      return this.httpClient.post(`/api/v1/tags/${tagId}/delete`);
app/static/js/modules/services/instance_management_service.js:70:      const endpoint = customUrl || "/api/v1/accounts/actions/sync";
app/static/js/modules/services/instance_management_service.js:76:      return this.httpClient.post(`/api/v1/instances/${instanceId}/actions/sync-capacity`);
app/static/js/modules/services/instance_management_service.js:80:      return this.httpClient.post("/api/v1/accounts/actions/sync-all");
app/static/js/modules/services/instance_management_service.js:89:        `/api/v1/instances/${instanceId}/accounts/${accountId}/change-history`,
app/static/js/modules/services/instance_management_service.js:99:        `/api/v1/instances/${instanceId}/accounts/${accountId}/permissions`,
app/static/js/modules/services/instance_management_service.js:107:        `/api/v1/instances/${instanceId}/databases/sizes${query}`,
app/static/js/modules/services/instance_management_service.js:115:      return this.httpClient.post("/api/v1/instances/batch-delete", {
app/static/js/modules/services/instance_management_service.js:124:      return this.httpClient.post("/api/v1/instances/batch-create", formData);
app/static/js/modules/services/instance_management_service.js:129:      return this.httpClient.post(`/api/v1/instances/${instanceId}/restore`);
app/static/js/modules/services/instance_management_service.js:133:      return this.httpClient.get("/api/v1/instances/statistics");
app/static/js/modules/services/instance_service.js:4:  const BASE_PATH = "/api/v1/instances";
app/static/js/modules/views/instances/detail.js:559:        apiUrl: `/api/v1/instances/${getInstanceId()}/accounts/${accountId}/permissions`
app/static/js/modules/views/instances/detail.js:643:    return `/api/v1/instances/${getInstanceId()}/accounts?sort=username&order=asc`;
app/static/js/modules/views/instances/detail.js:911:    return `/api/v1/instances/${getInstanceId()}/databases/sizes`;
app/__init__.py:287:            # 仅允许对外 JSON API(`/api/v1/**`) 走 CORS.
app/__init__.py:288:            r"^/api/v1/.*": {
app/templates/instances/detail.html:13:     data-sync-accounts-url="/api/v1/accounts/actions/sync">
app/static/js/modules/views/instances/list.js:734:        const base = '/api/v1/instances';
app/templates/instances/modals/batch-create-modal.html:8:                <a href="/api/v1/files/template-download" class="text-decoration-none">
app/static/js/modules/views/auth/list.js:124:          url: "/api/v1/users?sort=created_at&order=desc",
app/routes/auth.py:154:# legacy `*/api/*` JSON API 已迁移到 `/api/v1/**`, 旧路径不再提供路由.
app/templates/instances/list.html:32:     data-export-url="/api/v1/files/instance-export"
app/static/js/modules/views/capacity/databases.js:89:        summaryEndpoint: "/api/v1/capacity/databases/summary",
app/static/js/modules/views/capacity/databases.js:90:        trendEndpoint: "/api/v1/capacity/databases",
app/static/js/modules/views/capacity/databases.js:91:        changeEndpoint: "/api/v1/capacity/databases",
app/static/js/modules/views/capacity/databases.js:92:        percentEndpoint: "/api/v1/capacity/databases",
app/static/js/modules/views/capacity/databases.js:111:        calculateEndpoint: "/api/v1/capacity/aggregations/current",
app/static/js/modules/views/capacity/databases.js:112:        instanceOptionsEndpoint: "/api/v1/common/instances/options",
app/static/js/modules/views/capacity/databases.js:113:        databaseOptionsEndpoint: "/api/v1/common/databases/options",
app/static/js/modules/views/auth/modals/user-modals.js:147:        const payload = await http.get(`/api/v1/users/${userId}`);
app/static/js/modules/views/auth/modals/user-modals.js:257:      http.post('/api/v1/users', payload)
app/static/js/modules/views/auth/modals/user-modals.js:286:      http.put(`/api/v1/users/${userId}`, payload)
app/static/js/modules/views/capacity/instances.js:71:        summaryEndpoint: "/api/v1/capacity/instances/summary",
app/static/js/modules/views/capacity/instances.js:72:        trendEndpoint: "/api/v1/capacity/instances",
app/static/js/modules/views/capacity/instances.js:73:        changeEndpoint: "/api/v1/capacity/instances",
app/static/js/modules/views/capacity/instances.js:74:        percentEndpoint: "/api/v1/capacity/instances",
app/static/js/modules/views/capacity/instances.js:86:        calculateEndpoint: "/api/v1/capacity/aggregations/current",
app/static/js/modules/views/capacity/instances.js:87:        instanceOptionsEndpoint: "/api/v1/common/instances/options",
app/static/js/modules/views/history/logs/logs.js:112:                    url: '/api/v1/history/logs/list?sort=timestamp&order=desc',
app/static/js/modules/views/history/sessions/sync-sessions.js:148:          url: '/api/v1/history/sessions?sort=started_at&order=desc',
app/static/js/modules/views/tags/modals/tag-modals.js:159:        const payload = await http.get(`/api/v1/tags/${tagId}`);
app/static/js/modules/views/tags/modals/tag-modals.js:232:      http.post('/api/v1/tags', payload)
app/static/js/modules/views/tags/modals/tag-modals.js:261:      http.put(`/api/v1/tags/${tagId}`, payload)
app/static/js/modules/views/tags/index.js:101:          url: "/api/v1/tags",
app/static/js/modules/views/tags/index.js:265:      const resp = await http.post(`/api/v1/tags/${tagId}/delete`, {});
app/static/js/modules/views/admin/partitions/partition-list.js:72:          url: "/api/v1/partition/partitions?sort=name&order=asc",
app/static/js/modules/views/accounts/statistics.js:5:  const API_ENDPOINT = '/api/v1/accounts/statistics';
app/static/js/modules/views/accounts/ledgers.js:56:  const exportEndpoint = pageRoot.dataset.exportUrl || "/api/v1/files/account-export";
app/static/js/modules/views/accounts/ledgers.js:125:          url: "/api/v1/accounts/ledgers?sort=username&order=asc",
app/static/js/modules/views/accounts/ledgers.js:694:      apiUrl: `/api/v1/accounts/ledgers/${accountId}/permissions`,
app/static/js/modules/views/components/connection-manager.js:21:        this.baseUrl = '/api/v1/connections';
app/static/js/modules/views/admin/scheduler/index.js:225:     * - 向后端 /api/v1/scheduler/jobs/reload 发送 POST 请求
app/static/js/modules/views/components/tags/tag-selector-controller.js:16:    tags: "/api/v1/tags/options",
app/static/js/modules/views/components/tags/tag-selector-controller.js:17:    categories: "/api/v1/tags/categories",
app/templates/accounts/ledgers.html:27:<div id="accounts-page-root" data-current-db-type="{{ current_db_type or 'all' }}" data-export-url="/api/v1/files/account-export">
app/templates/databases/ledgers.html:19:     data-api-url="/api/v1/databases/ledgers"
app/templates/databases/ledgers.html:20:     data-export-url="/api/v1/files/database-ledger-export"
app/static/js/modules/views/components/permissions/permission-viewer.js:90:            apiUrl = `/api/v1/accounts/ledgers/${accountId}/permissions`,
app/static/js/modules/views/components/permissions/permission-viewer.js:137:    function fetchAccountPermissions(accountId, apiUrl = `/api/v1/accounts/ledgers/${accountId}/permissions`) {
app/templates/base.html:314:                    const payload = await client.get('/api/v1/admin/app-info');
app/api/__init__.py:4:- 新增 `/api/v1/**` 版本化 API blueprint
app/api/__init__.py:19:    - `/api/v1/**` 为唯一可用的对外 JSON API.
app/api/__init__.py:22:    from app.api.v1 import create_api_v1_blueprint  # noqa: PLC0415
app/api/__init__.py:24:    api_v1_bp = create_api_v1_blueprint(settings)
app/api/__init__.py:25:    app.register_blueprint(api_v1_bp, url_prefix="/api/v1")
app/templates/about.html:35:    {"version": "1.3.6", "date": "2025-12-30", "summary": "核心升级：GRID 组件化，补充标准化文档；全局版本号与可见页面同步更新至 v1.3.6。", "status": "info", "tag": "GRID 组件化"},
app/templates/about.html:36:    {"version": "1.3.5", "date": "2025-12-24", "summary": "按版本升级指南同步全局版本号至 v1.3.5，清单文件与可见页面版本信息同步更新。", "status": "muted", "tag": "版本同步"},
app/templates/about.html:42:    {"version": "1.2.3", "date": "2025-11-26", "summary": "注释/Docstring 全面补齐，版本号统一至 v1.2.3，关于页与部署文档同步更新。", "status": "info", "tag": "文档同步"},
app/api/v1/api.py:21:        """为 `/api/v1/` 提供可发现性入口(避免误判“未部署”)."""
app/api/v1/api.py:31:            message="API v1 已就绪",
app/api/v1/__init__.py:1:"""API v1 (Flask-RESTX).
app/api/v1/__init__.py:13:from app.api.v1.api import WhaleFallApi
app/api/v1/__init__.py:14:from app.api.v1.namespaces.accounts import ns as accounts_ns
app/api/v1/__init__.py:15:from app.api.v1.namespaces.accounts_classifications import ns as accounts_classifications_ns
app/api/v1/__init__.py:16:from app.api.v1.namespaces.admin import ns as admin_ns
app/api/v1/__init__.py:17:from app.api.v1.namespaces.auth import ns as auth_ns
app/api/v1/__init__.py:18:from app.api.v1.namespaces.cache import ns as cache_ns
app/api/v1/__init__.py:19:from app.api.v1.namespaces.capacity import ns as capacity_ns
app/api/v1/__init__.py:20:from app.api.v1.namespaces.common import ns as common_ns
app/api/v1/__init__.py:21:from app.api.v1.namespaces.connections import ns as connections_ns
app/api/v1/__init__.py:22:from app.api.v1.namespaces.credentials import ns as credentials_ns
app/api/v1/__init__.py:23:from app.api.v1.namespaces.dashboard import ns as dashboard_ns
app/api/v1/__init__.py:24:from app.api.v1.namespaces.databases import ns as databases_ns
app/api/v1/__init__.py:25:from app.api.v1.namespaces.files import ns as files_ns
app/api/v1/__init__.py:26:from app.api.v1.namespaces.health import ns as health_ns
app/api/v1/__init__.py:27:from app.api.v1.namespaces.history_logs import ns as history_logs_ns
app/api/v1/__init__.py:28:from app.api.v1.namespaces.history_sessions import ns as history_sessions_ns
app/api/v1/__init__.py:29:from app.api.v1.namespaces.instances import ns as instances_ns
app/api/v1/__init__.py:30:from app.api.v1.namespaces.partition import ns as partition_ns
app/api/v1/__init__.py:31:from app.api.v1.namespaces.scheduler import ns as scheduler_ns
app/api/v1/__init__.py:32:from app.api.v1.namespaces.tags import ns as tags_ns
app/api/v1/__init__.py:33:from app.api.v1.namespaces.tags_bulk import ns as tags_bulk_ns
app/api/v1/__init__.py:34:from app.api.v1.namespaces.users import ns as users_ns
app/api/v1/__init__.py:38:def create_api_v1_blueprint(settings: Settings) -> Blueprint:
app/api/v1/__init__.py:39:    """创建并配置 `/api/v1` Blueprint.
app/api/v1/__init__.py:42:    - Swagger UI: `/api/v1/docs`(可配置关闭)
app/api/v1/__init__.py:43:    - OpenAPI JSON: `/api/v1/openapi.json`
app/api/v1/__init__.py:45:    blueprint = Blueprint("api_v1", __name__)
app/api/v1/__init__.py:47:    docs_path = "/docs" if settings.api_v1_docs_enabled else cast(str, False)
app/api/v1/resources/decorators.py:1:"""API v1 decorators.
app/api/v1/resources/decorators.py:4:- API v1 的错误语义应始终为 JSON（禁止 redirect/flash）
app/api/v1/resources/decorators.py:26:    """要求调用者已登录（API v1 专用）."""
app/api/v1/resources/decorators.py:46:    """校验指定权限(view/create/update/delete)（API v1 专用）."""
app/api/v1/resources/decorators.py:79:    """校验 view 权限（API v1 专用）."""
app/api/v1/resources/decorators.py:84:    """要求调用者为管理员（API v1 专用）."""
app/api/v1/namespaces/health.py:11:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/health.py:12:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/health.py:13:from app.api.v1.resources.decorators import api_login_required
app/api/v1/resources/__init__.py:1:"""API v1 resources."""
app/api/v1/namespaces/databases.py:8:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/databases.py:9:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/databases.py:10:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/accounts_classifications.py:13:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/accounts_classifications.py:14:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/accounts_classifications.py:15:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/files.py:13:from app.api.v1.models.envelope import get_error_envelope_model
app/api/v1/namespaces/files.py:14:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/files.py:15:from app.api.v1.resources.decorators import api_admin_required, api_login_required, api_permission_required
app/api/v1/namespaces/partition.py:9:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/partition.py:10:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/partition.py:11:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/history_sessions.py:9:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/history_sessions.py:10:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/history_sessions.py:11:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/accounts.py:15:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/accounts.py:16:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/accounts.py:17:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/auth.py:13:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/auth.py:14:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/auth.py:15:from app.api.v1.resources.decorators import api_login_required
app/api/v1/namespaces/auth.py:249:            context={"route": "api_v1.auth.refresh"},
app/api/v1/namespaces/capacity.py:10:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/capacity.py:11:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/capacity.py:12:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/credentials.py:11:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/credentials.py:12:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/credentials.py:13:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/scheduler.py:16:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/scheduler.py:17:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/scheduler.py:18:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/tags.py:11:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/tags.py:12:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/tags.py:13:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/users.py:9:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/users.py:10:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/users.py:11:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/__init__.py:1:"""API v1 namespaces."""
app/api/v1/namespaces/common.py:8:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/common.py:9:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/common.py:10:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/cache.py:10:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/cache.py:11:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/cache.py:12:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/admin.py:8:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/admin.py:9:from app.api.v1.resources.base import BaseResource
app/api/v1/models/__init__.py:1:"""API v1 models."""
app/api/v1/namespaces/connections.py:12:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/connections.py:13:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/connections.py:14:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/tags_bulk.py:9:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/tags_bulk.py:10:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/tags_bulk.py:11:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/dashboard.py:8:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/dashboard.py:9:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/dashboard.py:10:from app.api.v1.resources.decorators import api_login_required
app/api/v1/namespaces/history_logs.py:11:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/history_logs.py:12:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/history_logs.py:13:from app.api.v1.resources.decorators import api_login_required, api_permission_required
app/api/v1/namespaces/instances.py:17:from app.api.v1.models.envelope import get_error_envelope_model, make_success_envelope_model
app/api/v1/namespaces/instances.py:18:from app.api.v1.resources.base import BaseResource
app/api/v1/namespaces/instances.py:19:from app.api.v1.resources.decorators import api_login_required, api_permission_required
