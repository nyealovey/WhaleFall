<!-- 编辑任务模态框 -->
{% from 'components/ui/macros.html' import btn_close %}
<div class="modal fade" id="editJobModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-edit me-2"></i>编辑定时任务
                </h5>
                {{ btn_close('modal') }}
            </div>
            <form id="editJobForm">
                <div class="modal-body">
                    <div class="crud-modal">
                        <input type="hidden" id="editJobId" name="job_id" />

                        <div class="crud-modal__header">
                            <span class="chip-outline chip-outline--brand"><i class="fas fa-tasks me-2"></i>任务配置</span>
                            <span class="status-pill status-pill--info">编辑</span>
                        </div>

                        <div class="crud-modal__sections">
                            <section class="crud-modal__section">
                                <div class="crud-modal__section-title chip-outline chip-outline--muted">
                                    <i class="fas fa-info-circle me-2"></i>基础信息
                                </div>
                                <div class="row g-3">
                                    <div class="col-md-6 col-12">
                                        <label for="editJobName" class="form-label">任务名称 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editJobName" name="name" required>
                                        <div class="crud-modal__hint chip-outline chip-outline--muted">
                                            <i class="fas fa-tag"></i>建议使用可读性强的任务描述名称
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <label for="editJobFunction" class="form-label">执行函数 <span class="text-danger">*</span></label>
                                        <select class="form-select" id="editJobFunction" name="func" required>
                                            <option value="">请选择函数</option>
                                            <option value="sync_accounts">同步所有账户</option>
                                            <option value="cleanup_old_logs">清理旧日志</option>
                                            <option value="monitor_partition_health">监控分区健康状态</option>
                                            <option value="collect_database_sizes">容量同步</option>
                                            <option value="calculate_database_size_aggregations">统计聚合</option>
                                        </select>
                                        <div class="crud-modal__hint chip-outline chip-outline--muted">
                                            <i class="fas fa-code"></i>函数名称由后端注册，编辑时仅可查看
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section class="crud-modal__section edit-trigger-config show" id="editCronConfig">
                                <div class="crud-modal__section-title chip-outline chip-outline--muted">
                                    <i class="fas fa-clock me-2"></i>Cron 调度
                                </div>
                                <div class="row g-3">
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronSecond" class="form-label">秒 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronSecond" name="cron_second" placeholder="0-59" value="0">
                                    </div>
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronMinute" class="form-label">分钟 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronMinute" name="cron_minute" placeholder="0-59" value="0">
                                    </div>
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronHour" class="form-label">小时 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronHour" name="cron_hour" placeholder="0-23" value="0">
                                    </div>
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronDay" class="form-label">日 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronDay" name="cron_day" placeholder="1-31" value="*">
                                    </div>
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronMonth" class="form-label">月份 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronMonth" name="cron_month" placeholder="1-12" value="*">
                                    </div>
                                    <div class="col-6 col-md-4 col-lg-3">
                                        <label for="editCronWeekday" class="form-label">星期 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="editCronWeekday" name="cron_weekday" placeholder="0-6" value="*">
                                    </div>
                                    <div class="col-12 col-md-4 col-lg-3">
                                        <label for="editCronYear" class="form-label">年份</label>
                                        <input type="text" class="form-control" id="editCronYear" name="year" placeholder="2025 或 *" value="*">
                                    </div>
                                </div>
                                <div class="crud-modal__hint chip-outline chip-outline--muted mt-3">
                                    <i class="fas fa-lightbulb"></i>使用 * 表示任意值，"," 分隔多个值，"-" 表示范围，"/" 表示步长
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">保存修改</button>
                </div>
            </form>
        </div>
    </div>
</div>
