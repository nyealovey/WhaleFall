{% extends "base.html" %}

{% block title %}关于鲸落{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/about.css') }}">
{% endblock %}

{% block content %}
{% set feature_groups = [
    {"title": "数据库管理", "icon": "fas fa-database", "status": "info", "bullets": ["多数据库实例管理", "连接状态测试", "实例标签分类"]},
    {"title": "账户管理", "icon": "fas fa-users", "status": "success", "bullets": ["账户权限扫描", "智能分类管理", "权限规则配置", "账户状态监控"]},
    {"title": "任务调度", "icon": "fas fa-clock", "status": "warning", "bullets": ["定时数据同步", "容量同步"]},
    {"title": "监控与聚合", "icon": "fas fa-chart-line", "status": "danger", "bullets": ["统一日志与审计中心", "聚合服务周期统计", "同步会话追踪"]}
] %}
{% set stack_groups = [
    {"title": "后端技术", "entries": ["Python 3.11+", "Flask 3.1.2+", "SQLAlchemy 2.0.43+", "APScheduler 3.11.0+", "Redis 6.4.0+", "Gunicorn 23.0.0+", "Gevent 25.9.1+"]},
    {"title": "前端技术", "entries": ["Bootstrap 5.3.2", "jQuery 3.7.1", "Chart.js 4.4.0", "Font Awesome 6.4.0", "Jinja2 模板引擎"]}
] %}
{% set db_supports = [
    {"name": "PostgreSQL", "icon": "fas fa-database", "chips": [
        {"label": "11.x ~ 16.x"}
    ]},
    {"name": "MySQL", "icon": "fas fa-database", "chips": [
        {"label": "5.7 ~ 9.0"}
    ]},
    {"name": "SQL Server", "icon": "fas fa-database", "chips": [
        {"label": "2017 ~ 2022"}
    ]},
    {"name": "Oracle", "icon": "fas fa-database", "chips": [
        {"label": "12c ~ 21c"}
    ]}
] %}
{% set version_timeline = [
    {"version": "1.3.4", "date": "2025-12-16", "summary": "修复 Pyright 类型问题，补齐注解以确保静态检查零告警；全局版本号与可见页面同步更新。", "status": "success", "tag": "类型修复"},
    {"version": "1.3.3", "date": "2025-12-15", "summary": "RUFF 全面修复，清理告警并补齐类型与日志规范；版本号与可见页面同步更新。", "status": "success", "tag": "质量提升"},
    {"version": "1.3.2", "date": "2025-12-05", "summary": "统一实例/凭据/标签模态布局，移除标签颜色/排序并引入基础设施域、组织角色域、外部域三类父分类，版本号与脚本同步更新。", "status": "info", "tag": "UI 统一"},
    {"version": "1.3.1", "date": "2025-12-01", "summary": "全面修复 CRUD 流程：批量选择、CSV 导入、实例编辑入口等体验一致，清理残留命名与模板问题。", "status": "success", "tag": "CRUD 稳定"},
    {"version": "1.3.0", "date": "2025-12-01", "summary": "统一 UI 视觉体系、完成命名规范重构，并为核心接口补齐 Google 风格注释。", "status": "info", "tag": "视觉治理"},
    {"version": "1.2.3", "date": "2025-11-26", "summary": "注释/Docstring 全面补齐，版本号统一至 v1.2.3，关于页与部署文档同步更新。", "status": "info", "tag": "文档同步"},
    {"version": "1.2.2", "date": "2025-11-13", "summary": "大幅重构与精简：调度器按需初始化 + 文件锁防并发，Scheduler 表单/日志全面瘦身，统一日志支持 JSONB 搜索。", "status": "warning", "tag": "调度精简"},
    {"version": "1.2.1", "date": "2025-11-05", "summary": "重构核心服务：统一账户同步、权限差异与变更日志链路，提升数据一致性与可观察性。", "status": "info", "tag": "核心重构"},
    {"version": "1.2.0", "date": "2025-10-31", "summary": "聚合服务职责梳理，手动/定时聚合流程统一，容量统计体验升级。", "status": "info", "tag": "聚合升级"},
    {"version": "1.1.4", "date": "2025-10-17", "summary": "时间处理和日志中心显示统一，聚合与日志体验优化。", "status": "muted", "tag": "体验优化"},
    {"version": "1.1.3", "date": "2025-10-14", "summary": "容量统计页面上线，日志中心体验优化，统计功能重构。", "status": "info", "tag": "统计增强"},
    {"version": "1.1.2", "date": "2025-10-13", "summary": "版本统一更新、样式优化、文档同步更新。", "status": "muted", "tag": "版本同步"},
    {"version": "1.1.1", "date": "2025-10-09", "summary": "容量同步修复脚本、容量趋势图交互优化以及分区与仪表板稳定性修复。", "status": "warning", "tag": "容量稳定"},
    {"version": "1.1.0", "date": "2025-09-25", "summary": "自动分类、标签管理、权限 API 与 JS 模块化修复。", "status": "info", "tag": "分类增强"},
    {"version": "1.0.8", "date": "2025-09-24", "summary": "新增批量标签管理功能、标签分组显示、实例分组管理。", "status": "info", "tag": "标签管理"},
    {"version": "1.0.7", "date": "2025-09-24", "summary": "自动分类规则与定时任务修复、用户管理增强、代码分离优化。", "status": "muted", "tag": "任务修复"},
    {"version": "1.0.6", "date": "2025-09-22", "summary": "权限 API 修复、SQL Server 权限修复、日志优化。", "status": "danger", "tag": "权限修复"},
    {"version": "1.0.5", "date": "2025-09-21", "summary": "账户分类分页功能、SQL Server 权限修复、生产环境优化与关于页面。", "status": "info", "tag": "账户增强"},
    {"version": "1.0.2", "date": "2025-09-20", "summary": "版本升级、生产环境部署、页脚版本号显示。", "status": "muted", "tag": "部署上线"},
    {"version": "1.0.0", "date": "2025-09-19", "summary": "正式版本发布、统一版本号、依赖升级。", "status": "success", "tag": "正式发布"}
] %}
{% set latest_release = version_timeline[0] %}
<div class="container-fluid about-page">
    <div class="row g-4">
        <div class="col-lg-6">
            <div class="card about-hero mb-4">
                <div class="card-body text-center">
                    <img src="{{ url_for('static', filename='img/logo.webp') }}" alt="鲸落" height="200"
                        class="mb-4 about-logo">
                    <div class="chip-outline chip-outline--brand mb-3">鲸落 WhaleFall</div>
                    <p class="about-hero-subtitle mb-3">面向 DBA 的数据库资源管理平台</p>
                    <span class="status-pill status-pill--info">
                        <i class="fas fa-bullseye me-2"></i> Kurtis.Jin
                    </span>
                </div>
            </div>

            <div class="card about-section-card mb-4">
                <div class="card-body">
                    <div class="about-section-heading">
                        <span class="chip-outline chip-outline--brand">
                            <i class="fas fa-info-circle me-2"></i>项目介绍
                        </span>
                        <span class="status-pill status-pill--muted">版本 1.3.4</span>
                    </div>
                    <p class="about-body-text mb-0">
                        鲸落聚焦实例、账户、容量与任务调度等日常运维场景，为 DBA 提供统一入口。系统内置实例与账户台账、权限治理、容量体检、调度编排等能力，借助结构化日志与可视化看板帮助团队快速识别风险、分配任务并跟踪执行效果。
                    </p>
                </div>
            </div>

            <div class="card about-section-card mb-4">
                <div class="card-body">
                    <div class="about-section-heading">
                        <span class="chip-outline chip-outline--brand">
                            <i class="fas fa-cogs me-2"></i>核心功能
                        </span>
                        <span class="status-pill status-pill--muted">组件复用</span>
                    </div>
                    <div class="about-feature-grid">
                        {% for feature in feature_groups %}
                        <div class="about-feature-item">
                            <span class="status-pill status-pill--{{ feature.status }}">
                                <i class="{{ feature.icon }} me-2"></i>{{ feature.title }}
                            </span>
                            <ul class="about-feature-list">
                                {% for bullet in feature.bullets %}
                                <li>{{ bullet }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card about-section-card mb-4">
                <div class="card-body">
                    <div class="about-section-heading">
                        <span class="chip-outline chip-outline--brand">
                            <i class="fas fa-code me-2"></i>技术栈
                        </span>
                        <span class="status-pill status-pill--info">持续升级</span>
                    </div>
                    <div class="about-stack-grid">
                        {% for stack in stack_groups %}
                        <div class="about-stack-column">
                            <div class="chip-outline chip-outline--muted mb-3">{{ stack.title }}</div>
                            <ul class="about-stack-list">
                                {% for entry in stack.entries %}
                                <li>{{ entry }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card about-section-card">
                <div class="card-body">
                    <div class="about-section-heading">
                        <span class="chip-outline chip-outline--brand">
                            <i class="fas fa-server me-2"></i>支持的数据库
                        </span>
                        <span class="status-pill status-pill--muted">全覆盖</span>
                    </div>
                    <div class="about-db-grid">
                        {% for db in db_supports %}
                        <div class="about-db-card">
                            <div class="about-db-icon">
                                <i class="{{ db.icon }}"></i>
                            </div>
                            <div class="about-db-name">{{ db.name }}</div>
                            <div class="ledger-chip-stack justify-content-center">
                                {% for chip in db.chips %}
                                <span class="ledger-chip{% if chip.muted %} ledger-chip--muted{% endif %}">{{ chip.label }}</span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card about-timeline-card">
                <div class="card-body">
                    <div class="about-section-heading">
                        <span class="chip-outline chip-outline--brand">
                            <i class="fas fa-history me-2"></i>更新日志
                        </span>
                        <span class="status-pill status-pill--muted">依时间排序</span>
                    </div>
                    <div class="about-timeline" role="region" aria-label="版本时间线">
                    {% for item in version_timeline[:10] %}
                        <div class="about-timeline-entry">
                            <div class="about-timeline-header">
                                <div class="ledger-chip-stack">
                                    <span class="ledger-chip">版本 {{ item.version }}</span>
                                    <span class="ledger-chip ledger-chip--muted">{{ item.tag }}</span>
                                </div>
                                <span class="status-pill status-pill--{{ item.status }}">
                                    <i class="fas fa-calendar-alt me-2"></i>{{ item.date }}
                                </span>
                            </div>
                            <p class="about-timeline-summary mb-0">{{ item.summary }}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
