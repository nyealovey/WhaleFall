{% set change_password_modal_body %}
<form id="changePasswordModalForm" class="crud-modal" data-form-mode="edit" autocomplete="off">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

    <div class="crud-modal__header">
        <span class="chip-outline chip-outline--brand">
            <i class="fas fa-key" aria-hidden="true"></i>
            <span>修改密码</span>
        </span>
        <span class="status-pill status-pill--muted" id="changePasswordModalMetaPill">
            <i class="fas fa-shield-alt" aria-hidden="true"></i>
            <span>将强制重新登录</span>
        </span>
    </div>

    <div class="crud-modal__sections">
        <section class="crud-modal__section">
            <div class="crud-modal__section-title">
                <span class="chip-outline chip-outline--muted">
                    <i class="fas fa-lock" aria-hidden="true"></i>
                    <span>安全校验</span>
                </span>
                <span class="crud-modal__muted-text">请输入当前密码并设置新密码</span>
            </div>
            <div class="row g-3">
                <div class="col-12">
                    <label for="old_password" class="form-label">当前密码 <span class="text-danger">*</span></label>
                    <input
                        type="password"
                        class="form-control"
                        id="old_password"
                        name="old_password"
                        autocomplete="current-password"
                        required
                    />
                </div>
                <div class="col-md-6 col-12">
                    <label for="new_password" class="form-label">新密码 <span class="text-danger">*</span></label>
                    <input
                        type="password"
                        class="form-control"
                        id="new_password"
                        name="new_password"
                        autocomplete="new-password"
                        required
                    />
                    <div class="form-text">建议至少 8 位，包含大小写字母与数字</div>
                </div>
                <div class="col-md-6 col-12">
                    <label for="confirm_password" class="form-label">确认新密码 <span class="text-danger">*</span></label>
                    <input
                        type="password"
                        class="form-control"
                        id="confirm_password"
                        name="confirm_password"
                        autocomplete="new-password"
                        required
                    />
                </div>
            </div>
        </section>
    </div>
</form>
{% endset %}

{% set change_password_modal_footer %}
<div class="modal-footer__actions d-flex flex-wrap align-items-center gap-3 w-100">
    <span class="text-muted small me-auto">
        <i class="fas fa-info-circle me-1" aria-hidden="true"></i>修改成功后将自动退出并跳转登录页
    </span>
    <div class="d-flex flex-wrap gap-2">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal" aria-label="取消并关闭模态">取消</button>
        <button type="submit" class="btn btn-primary" id="changePasswordModalSubmit" form="changePasswordModalForm" aria-label="提交修改密码">更新密码</button>
    </div>
</div>
{% endset %}

{% with
    modal_id='changePasswordModal',
    modal_label_id='changePasswordModalLabel',
    title='<i class="fas fa-key me-2" aria-hidden="true"></i><span>修改密码</span>',
    body=change_password_modal_body,
    footer=change_password_modal_footer,
    size='lg',
    body_class='p-4'
%}
    {% include 'components/ui/modal.html' %}
{% endwith %}

