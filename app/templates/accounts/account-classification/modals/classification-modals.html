{# 分类新建/编辑模态，各页面共用 #}
{% set create_classification_modal_body %}
    <form id="createClassificationForm" class="crud-modal">
        <div class="crud-modal__header">
            <span class="chip-outline chip-outline--brand">
                <i class="fas fa-tags" aria-hidden="true"></i>
                <span>分类配置</span>
            </span>
            <span class="status-pill status-pill--muted">
                <i class="fas fa-sparkles" aria-hidden="true"></i>
                <span>新建</span>
            </span>
        </div>
        <div class="crud-modal__sections">
            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-layer-group" aria-hidden="true"></i>
                        <span>基础信息</span>
                    </span>
                    <span class="crud-modal__muted-text">输入分类名称与业务说明</span>
                </div>
                <div class="row g-3 align-items-start">
                    <div class="col-md-6 col-12">
                        <label for="classificationName" class="form-label">分类名称 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="classificationName" required>
                    </div>
                    <div class="col-md-6 col-12">
                        <label for="classificationDescription" class="form-label">描述</label>
                        <textarea class="form-control" id="classificationDescription" rows="3" placeholder="简要说明分类适用场景"></textarea>
                    </div>
                </div>
            </section>

            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-signal" aria-hidden="true"></i>
                        <span>风险与色彩</span>
                    </span>
                    <span class="crud-modal__muted-text">确定警戒级别与展示色</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-6 col-12">
                        <label for="riskLevel" class="form-label">风险等级</label>
                        <select class="form-select" id="riskLevel">
                            <option value="low">低风险</option>
                            <option value="medium" selected>中风险</option>
                            <option value="high">高风险</option>
                            <option value="critical">极高风险</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-12">
                        <label for="classificationColor" class="form-label">显示颜色 <span class="text-danger">*</span></label>
                        <select class="form-select" id="classificationColor" required>
                            <option value="">请选择颜色</option>
                            {% for key, info in color_options.items() %}
                            <option value="{{ key }}" data-color="{{ info.value }}">
                                {{ info.name }} - {{ info.description }}
                            </option>
                            {% endfor %}
                        </select>
                        <div class="crud-modal__hint mt-2">
                            <div id="colorPreview" class="color-preview-container" style="display: none;">
                                <span class="color-preview-dot"></span>
                                <span class="color-preview-text"></span>
                            </div>
                            <span class="crud-modal__muted-text">用于列表 chip 与统计卡片</span>
                        </div>
                    </div>
                </div>
            </section>

            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-sliders" aria-hidden="true"></i>
                        <span>图标与优先级</span>
                    </span>
                    <span class="crud-modal__muted-text">统一配置徽标与展示顺序</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-8 col-12">
                        <p class="mb-2 fw-semibold">图标选择</p>
                        <div class="row g-2">
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconCrown" value="fa-crown">
                                    <label class="form-check-label" for="iconCrown">
                                        <i class="fas fa-crown text-warning"></i> 皇冠
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconShield" value="fa-shield-alt">
                                    <label class="form-check-label" for="iconShield">
                                        <i class="fas fa-shield-alt text-primary"></i> 盾牌
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconWarning" value="fa-exclamation-triangle">
                                    <label class="form-check-label" for="iconWarning">
                                        <i class="fas fa-exclamation-triangle text-danger"></i> 警告
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconUser" value="fa-user">
                                    <label class="form-check-label" for="iconUser">
                                        <i class="fas fa-user text-info"></i> 用户
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconEye" value="fa-eye">
                                    <label class="form-check-label" for="iconEye">
                                        <i class="fas fa-eye text-success"></i> 眼睛
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="classificationIcon" id="iconTag" value="fa-tag" checked>
                                    <label class="form-check-label" for="iconTag">
                                        <i class="fas fa-tag text-secondary"></i> 标签
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-12">
                        <label for="priority" class="form-label">优先级</label>
                        <input type="number" class="form-control" id="priority" value="0" min="0" max="100">
                        <div class="crud-modal__muted-text mt-2">数值越大越靠前</div>
                    </div>
                </div>
            </section>
        </div>
    </form>
{% endset %}
{% set create_classification_modal_footer %}
    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal" data-modal-cancel>取消</button>
    <button type="button" class="btn btn-primary" data-modal-confirm id="createClassificationConfirm">创建</button>
{% endset %}
{% with
    modal_id='createClassificationModal',
    modal_label_id='createClassificationModalLabel',
    title='<i class="fas fa-plus me-2"></i><span id="createClassificationModalTitle">新建分类</span>',
    body=create_classification_modal_body,
    footer=create_classification_modal_footer,
    body_class='p-4',
    size='lg'
%}
    {% include 'components/ui/modal.html' %}
{% endwith %}

{% set edit_classification_modal_header %}
<span class="crud-modal__heading">
    <span class="chip-outline chip-outline--brand">
        <i class="fas fa-tags" aria-hidden="true"></i>
        <span>账户分类</span>
    </span>
    <span class="crud-modal__title-group">
        <span class="crud-modal__title" id="editClassificationModalTitle">编辑分类</span>
    </span>
</span>
{% endset %}

{% set edit_classification_modal_body %}
    <form id="editClassificationForm" class="crud-modal">
        <input type="hidden" id="editClassificationId">
        <div class="crud-modal__header">
            <span class="chip-outline chip-outline--brand">
                <i class="fas fa-tags" aria-hidden="true"></i>
                <span>分类配置</span>
            </span>
            <span class="status-pill status-pill--info">
                <i class="fas fa-pen-to-square" aria-hidden="true"></i>
                <span>编辑</span>
            </span>
        </div>
        <div class="crud-modal__sections">
            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-layer-group" aria-hidden="true"></i>
                        <span>基础信息</span>
                    </span>
                    <span class="crud-modal__muted-text">更新分类名称与描述</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-6 col-12">
                        <label for="editClassificationName" class="form-label">分类名称 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="editClassificationName" required>
                    </div>
                    <div class="col-md-6 col-12">
                        <label for="editClassificationDescription" class="form-label">描述</label>
                        <textarea class="form-control" id="editClassificationDescription" rows="3"></textarea>
                    </div>
                </div>
            </section>

            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-signal" aria-hidden="true"></i>
                        <span>风险与色彩</span>
                    </span>
                    <span class="crud-modal__muted-text">匹配既有策略的风险色彩</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-6 col-12">
                        <label for="editClassificationRiskLevel" class="form-label">风险等级</label>
                        <select class="form-select" id="editClassificationRiskLevel">
                            <option value="low">低风险</option>
                            <option value="medium">中风险</option>
                            <option value="high">高风险</option>
                            <option value="critical">极高风险</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-12">
                        <label for="editClassificationColor" class="form-label">显示颜色 <span class="text-danger">*</span></label>
                        <select class="form-select" id="editClassificationColor" required>
                            <option value="">请选择颜色</option>
                            {% for key, info in color_options.items() %}
                            <option value="{{ key }}" data-color="{{ info.value }}">
                                {{ info.name }} - {{ info.description }}
                            </option>
                            {% endfor %}
                        </select>
                        <div class="crud-modal__hint mt-2">
                            <div id="editColorPreview" class="color-preview-container" style="display: none;">
                                <span class="color-preview-dot"></span>
                                <span class="color-preview-text"></span>
                            </div>
                            <span class="crud-modal__muted-text">同步到账户列表与统计图例</span>
                        </div>
                    </div>
                </div>
            </section>

            <section class="crud-modal__section">
                <div class="crud-modal__section-title">
                    <span class="chip-outline chip-outline--muted">
                        <i class="fas fa-sliders" aria-hidden="true"></i>
                        <span>图标与优先级</span>
                    </span>
                    <span class="crud-modal__muted-text">确保展示层级与符号一致</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-8 col-12">
                        <p class="mb-2 fw-semibold">图标选择</p>
                        <div class="row g-2">
                            {% set icons = [
                                ('editIconCrown', 'fa-crown', 'text-warning', '皇冠'),
                                ('editIconShield', 'fa-shield-alt', 'text-primary', '盾牌'),
                                ('editIconWarning', 'fa-exclamation-triangle', 'text-danger', '警告'),
                                ('editIconUser', 'fa-user', 'text-info', '用户'),
                                ('editIconEye', 'fa-eye', 'text-success', '眼睛'),
                                ('editIconTag', 'fa-tag', 'text-secondary', '标签')
                            ] %}
                            {% for control_id, icon_name, icon_class, label in icons %}
                            <div class="col-4 col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="editClassificationIcon" id="{{ control_id }}" value="{{ icon_name }}">
                                    <label class="form-check-label" for="{{ control_id }}">
                                        <i class="fas {{ icon_name }} {{ icon_class }}"></i> {{ label }}
                                    </label>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-4 col-12">
                        <label for="editClassificationPriority" class="form-label">优先级</label>
                        <input type="number" class="form-control" id="editClassificationPriority" value="0" min="0" max="100">
                        <div class="crud-modal__muted-text mt-2">0-100，越高越优先</div>
                    </div>
                </div>
            </section>
        </div>
    </form>
{% endset %}
{% set edit_classification_modal_footer %}
    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal" data-modal-cancel>取消</button>
    <button type="button" class="btn btn-primary" data-modal-confirm id="editClassificationConfirm">保存</button>
{% endset %}
{% with
    modal_id='editClassificationModal',
    modal_label_id='editClassificationModalLabel',
    title='<i class="fas fa-edit me-2"></i><span id="editClassificationModalTitle">编辑分类</span>',
    body=edit_classification_modal_body,
    footer=edit_classification_modal_footer,
    body_class='p-4',
    size='lg'
%}
    {% include 'components/ui/modal.html' %}
{% endwith %}
