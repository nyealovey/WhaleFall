{% set credential_modal_body %}
<form id="credentialModalForm" data-form-mode="create">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
    <input type="hidden" name="credential_id" id="credentialIdInput" />

    <div class="row">
        <div class="col-6">
            <div class="mb-3">
                <label for="credentialName" class="form-label">凭据名称 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="credentialName" name="name" placeholder="请输入凭据名称" required />
            </div>
        </div>
        <div class="col-6">
            <div class="mb-3">
                <label for="credentialType" class="form-label">凭据类型 <span class="text-danger">*</span></label>
                <select class="form-select" id="credentialType" name="credential_type" required>
                    <option value="">请选择类型</option>
                    {% for option in credential_type_options %}
                    <option value="{{ option.value }}">{{ option.label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-6">
            <div class="mb-3">
                <label for="credentialUsername" class="form-label">用户名 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="credentialUsername" name="username" placeholder="请输入用户名" required autocomplete="username" />
            </div>
        </div>
        <div class="col-6">
            <div class="mb-3">
                <label for="credentialPassword" class="form-label">密码 <span class="text-danger">*</span></label>
                <div class="input-group">
                    <input type="password" class="form-control" id="credentialPassword" name="password" placeholder="请输入密码" required autocomplete="current-password"/>
                    <button class="btn btn-outline-secondary" type="button" id="credentialTogglePassword">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="form-text">密码将被加密存储，编辑时留空表示保持原密码</div>
            </div>
        </div>
    </div>

    <div class="mb-3" id="credentialDbTypeField">
        <label for="credentialDbType" class="form-label">数据库类型</label>
        <select class="form-select" id="credentialDbType" name="db_type">
            <option value="">请选择数据库类型</option>
            {% for option in db_type_options %}
            <option value="{{ option.value }}">{{ option.label }}</option>
            {% endfor %}
        </select>
        <div class="form-text">仅当凭据类型为“数据库”时需要选择</div>
    </div>

    <div class="mb-3">
        <label for="credentialDescription" class="form-label">描述</label>
        <textarea class="form-control" id="credentialDescription" name="description" rows="3" placeholder="请输入凭据描述"></textarea>
    </div>

    <div class="form-check form-switch mb-3">
        <input class="form-check-input" type="checkbox" role="switch" id="credentialIsActive" name="is_active" value="1" checked />
        <label class="form-check-label" for="credentialIsActive">启用此凭据</label>
    </div>
</form>
{% endset %}

{% set credential_modal_footer %}
<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
<button type="button" class="btn btn-primary" data-modal-confirm id="credentialModalSubmit">添加凭据</button>
{% endset %}

{% with
    modal_id='credentialModal',
    modal_label_id='credentialModalLabel',
    title='<i class="fas fa-key me-2"></i><span id="credentialModalTitle">添加凭据</span>',
    body=credential_modal_body,
    footer=credential_modal_footer,
    size='lg'
%}
    {% include 'components/ui/modal.html' %}
{% endwith %}
